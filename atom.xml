<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>djdgctw çš„ç¡¬ä»¶ç¬”è®°</title>
  
  <subtitle>FPGA Â· Verilog Â· HDMI Â· SpinalHDL</subtitle>
  <link href="https://djdgctw.github.io/atom.xml" rel="self"/>
  
  <link href="https://djdgctw.github.io/"/>
  <updated>2025-11-23T06:31:28.059Z</updated>
  <id>https://djdgctw.github.io/</id>
  
  <author>
    <name>djdgctw</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>åŸºäº Python çš„ Cocotb ä»¿çœŸç¯å¢ƒé…ç½®ï¼šVerilator Â· Cocotb Â· GTKWave</title>
    <link href="https://djdgctw.github.io/2025/11/23/%E5%9F%BA%E4%BA%8Epython%E7%9A%84cocotb%E5%BA%93%E5%AF%B9verilog%E8%BF%9B%E8%A1%8C%E4%BB%BF%E7%9C%9F%E6%95%99%E7%A8%8B-%E5%89%8D%E4%BC%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%8F%8A%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"/>
    <id>https://djdgctw.github.io/2025/11/23/%E5%9F%BA%E4%BA%8Epython%E7%9A%84cocotb%E5%BA%93%E5%AF%B9verilog%E8%BF%9B%E8%A1%8C%E4%BB%BF%E7%9C%9F%E6%95%99%E7%A8%8B-%E5%89%8D%E4%BC%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%8F%8A%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/</id>
    <published>2025-11-23T06:30:00.000Z</published>
    <updated>2025-11-23T06:31:28.059Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>â€œè·‘é€š demo ä¹‹å‰ï¼Œå…ˆæŠŠç¯å¢ƒé…ç¨³å®šã€‚â€ â€”â€” æŠŠæ¯ä¸€æ­¥éƒ½å†™æ¸…æ¥šï¼Œåç»­å®éªŒå°±èƒ½å¿«é€Ÿå¤ç°ã€‚</p></blockquote><h2 id="1-Python-Cocotb-å®‰è£…"><a href="#1-Python-Cocotb-å®‰è£…" class="headerlink" title="1. Python &amp; Cocotb å®‰è£…"></a>1. Python &amp; Cocotb å®‰è£…</h2><h3 id="1-1-Python-ç¯å¢ƒ"><a href="#1-1-Python-ç¯å¢ƒ" class="headerlink" title="1.1 Python ç¯å¢ƒ"></a>1.1 Python ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¨è Python 3.10+ï¼Œconda / pyenv å‡å¯</span></span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install python3 python3-pip python3-venv -y</span><br><span class="line"></span><br><span class="line">python3 -m venv ~/.venvs/cocotb</span><br><span class="line"><span class="built_in">source</span> ~/.venvs/cocotb/bin/activate</span><br></pre></td></tr></table></figure><h3 id="1-2-å®‰è£…-Cocotb-åŠå¸¸ç”¨ä¾èµ–"><a href="#1-2-å®‰è£…-Cocotb-åŠå¸¸ç”¨ä¾èµ–" class="headerlink" title="1.2 å®‰è£… Cocotb åŠå¸¸ç”¨ä¾èµ–"></a>1.2 å®‰è£… Cocotb åŠå¸¸ç”¨ä¾èµ–</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install --upgrade pip wheel</span><br><span class="line">pip install cocotb cocotb-bus pytest</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœä½¿ç”¨ VS Codeï¼Œè®°å¾—æŠŠè™šæ‹Ÿç¯å¢ƒæŒ‡å‘ <code>~/.venvs/cocotb</code>.</p></blockquote><h2 id="2-Verilator-å®‰è£…"><a href="#2-Verilator-å®‰è£…" class="headerlink" title="2. Verilator å®‰è£…"></a>2. Verilator å®‰è£…</h2><h3 id="2-1-apt-å®‰è£…ï¼ˆç®€å•ï¼‰"><a href="#2-1-apt-å®‰è£…ï¼ˆç®€å•ï¼‰" class="headerlink" title="2.1 apt å®‰è£…ï¼ˆç®€å•ï¼‰"></a>2.1 apt å®‰è£…ï¼ˆç®€å•ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install verilator -y</span><br><span class="line">verilator --version</span><br></pre></td></tr></table></figure><h3 id="2-2-æºç å®‰è£…ï¼ˆéœ€è¦æœ€æ–°ç‰ˆæœ¬æ—¶ï¼‰"><a href="#2-2-æºç å®‰è£…ï¼ˆéœ€è¦æœ€æ–°ç‰ˆæœ¬æ—¶ï¼‰" class="headerlink" title="2.2 æºç å®‰è£…ï¼ˆéœ€è¦æœ€æ–°ç‰ˆæœ¬æ—¶ï¼‰"></a>2.2 æºç å®‰è£…ï¼ˆéœ€è¦æœ€æ–°ç‰ˆæœ¬æ—¶ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install git perl python3 make autoconf g++ flex bison libfl2 libfl-dev \</span><br><span class="line">  zlibc zlib1g zlib1g-dev -y</span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/verilator/verilator.git</span><br><span class="line"><span class="built_in">cd</span> verilator</span><br><span class="line">git checkout v5.026   <span class="comment"># æ ¹æ®éœ€è¦é€‰æ‹©ç‰ˆæœ¬</span></span><br><span class="line">autoconf</span><br><span class="line">./configure</span><br><span class="line">make -j$(<span class="built_in">nproc</span>)</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœç³»ç»Ÿå·²æœ‰æ—§ç‰ˆæœ¬ï¼Œå¯åœ¨ <code>~/.bashrc</code> ä¸­å°† <code>/usr/local/bin</code> æåˆ° <code>PATH</code> å‰é¢ï¼Œè®©æ–°ç‰ˆæœ¬ä¼˜å…ˆã€‚</p></blockquote><h2 id="3-GTKWave-å®‰è£…ï¼ˆæ³¢å½¢æŸ¥çœ‹ï¼‰"><a href="#3-GTKWave-å®‰è£…ï¼ˆæ³¢å½¢æŸ¥çœ‹ï¼‰" class="headerlink" title="3. GTKWave å®‰è£…ï¼ˆæ³¢å½¢æŸ¥çœ‹ï¼‰"></a>3. GTKWave å®‰è£…ï¼ˆæ³¢å½¢æŸ¥çœ‹ï¼‰</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install gtkwave -y</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨å¯åŠ¨æ–¹å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gtkwave logs/dump.vcd &amp;</span><br></pre></td></tr></table></figure><p>é…åˆ Verilator&#x2F;Cocotb ç”Ÿæˆçš„ <code>.vcd</code> æˆ– <code>.fst</code> æ–‡ä»¶å³å¯ã€‚</p><h2 id="4-ä»¿çœŸå·¥ç¨‹æ¨¡æ¿åˆå§‹åŒ–"><a href="#4-ä»¿çœŸå·¥ç¨‹æ¨¡æ¿åˆå§‹åŒ–" class="headerlink" title="4. ä»¿çœŸå·¥ç¨‹æ¨¡æ¿åˆå§‹åŒ–"></a>4. ä»¿çœŸå·¥ç¨‹æ¨¡æ¿åˆå§‹åŒ–</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ~/workspace/cocotb-demo &amp;&amp; <span class="built_in">cd</span> <span class="variable">$_</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/djdgctw/first_cocotb_testbench.git</span><br><span class="line"><span class="built_in">cd</span> first_cocotb_testbench/01_base</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">which</span> verilator</span><br><span class="line">python -c <span class="string">&quot;import cocotb; print(cocotb.__version__)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œä¸€æ¬¡ demo</span></span><br><span class="line">make run-logged SIM=verilator</span><br></pre></td></tr></table></figure><p>è‹¥è¾“å‡º <code>INFO: Running on Verilator ...</code> å¹¶ç”Ÿæˆ <code>logs/report.log</code>ï¼Œè¯´æ˜ç¯å¢ƒ OKã€‚</p><h2 id="5-å¸¸è§é—®é¢˜"><a href="#5-å¸¸è§é—®é¢˜" class="headerlink" title="5. å¸¸è§é—®é¢˜"></a>5. å¸¸è§é—®é¢˜</h2><table><thead><tr><th>ç°è±¡</th><th>å¤„ç†</th></tr></thead><tbody><tr><td><code>verilator: command not found</code></td><td>æ£€æŸ¥ <code>PATH</code>ï¼Œç¡®è®¤ <code>/usr/bin</code> æˆ– <code>/usr/local/bin</code> è¢«åŒ…å«ã€‚</td></tr><tr><td><code>ImportError: No module named &#39;cocotb&#39;</code></td><td>è™šæ‹Ÿç¯å¢ƒæœªæ¿€æ´»æˆ– pip å®‰è£…åœ¨ç³»ç»Ÿ Pythonï¼Œé‡æ–° <code>source ~/.venvs/cocotb/bin/activate</code>ã€‚</td></tr><tr><td>GTKWave æ‰“ä¸å¼€ä¸­æ–‡è·¯å¾„</td><td>é¿å…æŠŠæ³¢å½¢æ–‡ä»¶æ”¾åœ¨å«ä¸­æ–‡ç©ºæ ¼çš„è·¯å¾„ï¼Œæˆ–ä½¿ç”¨ <code>LANG=en_US.UTF-8 gtkwave ...</code>ã€‚</td></tr></tbody></table><h2 id="6-åç»­æ–‡ç« "><a href="#6-åç»­æ–‡ç« " class="headerlink" title="6. åç»­æ–‡ç« "></a>6. åç»­æ–‡ç« </h2><ul><li><a href="../%E5%9F%BA%E4%BA%8Epython%E7%9A%84cocotb%E5%BA%93%E5%AF%B9verilog%E8%BF%9B%E8%A1%8C%E4%BB%BF%E7%9C%9F%E6%95%99%E7%A8%8B-%E4%B8%80">åŸºäº Python çš„ Cocotb åº“å¯¹ Verilog è¿›è¡Œä»¿çœŸæ•™ç¨‹ï¼ˆä¸€ï¼‰</a></li><li>å³å°†æ›´æ–°ï¼šæ³¢å½¢å¯è§†åŒ–ã€ä¸ ModelSim&#x2F;Vivado IP ååŒçš„å®è·µ</li></ul><p>åšå¥½ç¯å¢ƒä¹‹åï¼Œåç»­çš„ Cocotb å®éªŒå°±åªå‰©â€œå†™ testbench + make runâ€è¿™ä¸¤ä¸ªåŠ¨ä½œï¼Œç¥ç©å¾—å¼€å¿ƒã€‚</p>]]></content>
    
    
    <summary type="html">è®°å½•åœ¨ Ubuntu/WSL ä¸Šæ­å»º Cocotb + Verilator + GTKWave ä»¿çœŸç¯å¢ƒçš„å…¨è¿‡ç¨‹ï¼Œæ–¹ä¾¿å¿«é€Ÿå¤åˆ»ã€‚</summary>
    
    
    
    <category term="å·¥å…·é“¾" scheme="https://djdgctw.github.io/categories/%E5%B7%A5%E5%85%B7%E9%93%BE/"/>
    
    
    <category term="cocotb" scheme="https://djdgctw.github.io/tags/cocotb/"/>
    
    <category term="verilator" scheme="https://djdgctw.github.io/tags/verilator/"/>
    
    <category term="gtkwave" scheme="https://djdgctw.github.io/tags/gtkwave/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäº Python çš„ Cocotb åº“å¯¹ Verilog è¿›è¡Œä»¿çœŸæ•™ç¨‹ï¼ˆä¸€ï¼‰</title>
    <link href="https://djdgctw.github.io/2025/11/23/%E5%9F%BA%E4%BA%8Epython%E7%9A%84cocotb%E5%BA%93%E5%AF%B9verilog%E8%BF%9B%E8%A1%8C%E4%BB%BF%E7%9C%9F%E6%95%99%E7%A8%8B-%E4%B8%80/"/>
    <id>https://djdgctw.github.io/2025/11/23/%E5%9F%BA%E4%BA%8Epython%E7%9A%84cocotb%E5%BA%93%E5%AF%B9verilog%E8%BF%9B%E8%A1%8C%E4%BB%BF%E7%9C%9F%E6%95%99%E7%A8%8B-%E4%B8%80/</id>
    <published>2025-11-23T05:24:27.000Z</published>
    <updated>2025-11-23T06:28:38.974Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¡¹ç›®åœ°å€"><a href="#é¡¹ç›®åœ°å€" class="headerlink" title="é¡¹ç›®åœ°å€"></a>é¡¹ç›®åœ°å€</h2><p>ğŸ‘‰ <a href="https://github.com/djdgctw/first_cocotb_testbench">https://github.com/djdgctw/first_cocotb_testbench</a></p><p>æœ¬æ•™ç¨‹å¯¹åº”ä»“åº“çš„ <code>01_base</code> ç¤ºä¾‹ï¼Œæ˜¯ Verilator Ã— Cocotb å…¥é—¨çš„æœ€å°å¯è¿è¡Œå·¥ç¨‹ã€‚</p><h2 id="1-è·‘é€š-01-base-åŸºç¡€æµç¨‹"><a href="#1-è·‘é€š-01-base-åŸºç¡€æµç¨‹" class="headerlink" title="1. è·‘é€š 01_base åŸºç¡€æµç¨‹"></a>1. è·‘é€š 01_base åŸºç¡€æµç¨‹</h2><p>ç¯å¢ƒè¦æ±‚ï¼š</p><ol><li>Ubuntuï¼ˆæˆ– WSL2ï¼‰</li><li>Verilatorï¼ˆapt æˆ–æºç ç¼–è¯‘å‡å¯ï¼‰</li><li>Pythonï¼ˆconda &#x2F; ç³»ç»Ÿ Python å‡å¯ï¼‰</li><li><code>pip install cocotb</code></li></ol><p>å…‹éš†ä»“åº“åè¿›å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> first_cocotb_testbench/01_base</span><br></pre></td></tr></table></figure><p>é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š<br><img src="/img/01_cocotb/01.png" alt="01_baseé¡¹ç›®ç»“æ„ç¤ºæ„å›¾"></p><h2 id="2-ç¤ºä¾‹æµç¨‹è®²è§£"><a href="#2-ç¤ºä¾‹æµç¨‹è®²è§£" class="headerlink" title="2. ç¤ºä¾‹æµç¨‹è®²è§£"></a>2. ç¤ºä¾‹æµç¨‹è®²è§£</h2><p>åœ¨ <code>01_base</code> ç›®å½•ä¸‹æ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make run-logged SIM=verilator</span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤ä¼šï¼š</p><ul><li>è°ƒç”¨ cocotb çš„ Makefile ä½“ç³»</li><li>ä½¿ç”¨ Verilator å¯¹ <code>src/dff.sv</code> è¿›è¡Œç¼–è¯‘</li><li>è¿è¡Œ Python ä¾§çš„ testbench</li><li>å°†è¿è¡Œæ—¥å¿—ä¸æ³¢å½¢å­˜å…¥ <code>logs/</code> ç›®å½•ï¼ˆå« <code>report.log</code> ä¸æ³¢å½¢æ–‡ä»¶ï¼‰</li></ul><p>Makefile å…³é”®é€»è¾‘å¦‚ä¸‹ï¼š<br><img src="/img/01_cocotb/02.png" alt="makefileéƒ¨åˆ†ä»£ç "></p><h2 id="3-åŸç†è®²è§£"><a href="#3-åŸç†è®²è§£" class="headerlink" title="3. åŸç†è®²è§£"></a>3. åŸç†è®²è§£</h2><p>æœ¬ç¤ºä¾‹ç”± Verilog è®¾è®¡æ–‡ä»¶ <code>dff.sv</code> å’Œ Python Cocotb æµ‹è¯•æ–‡ä»¶ <code>test_dff.py</code> ç»„æˆï¼ŒäºŒè€…é€šè¿‡ cocotb çš„ VPI&#x2F;PLI æ¥å£å»ºç«‹äº¤äº’ã€‚</p><h3 id="3-1-Verilog-ä»£ç è®²è§£ï¼ˆè¢«æµ‹æ¨¡å—-DUTï¼‰"><a href="#3-1-Verilog-ä»£ç è®²è§£ï¼ˆè¢«æµ‹æ¨¡å—-DUTï¼‰" class="headerlink" title="3.1 Verilog ä»£ç è®²è§£ï¼ˆè¢«æµ‹æ¨¡å— DUTï¼‰"></a>3.1 Verilog ä»£ç è®²è§£ï¼ˆè¢«æµ‹æ¨¡å— DUTï¼‰</h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1us/1ns</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> dff (</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>] q,</span><br><span class="line">    <span class="keyword">input</span>  <span class="keyword">logic</span>       clk,</span><br><span class="line">    <span class="keyword">input</span>  <span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>] d</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    q &lt;= d;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><p>è§£é‡Šï¼š</p><ul><li>ä¸Šå‡æ²¿é‡‡æ ·ï¼šæ¯ä¸ª <code>posedge clk</code>ï¼Œ<code>q</code> éƒ½ä¼šæ›´æ–°ä¸º <code>d</code></li><li>å»¶è¿Ÿè¯­ä¹‰ï¼šè¡Œä¸ºç­‰ä»·äº â€œq &#x3D; d ä¸Šä¸€æ‹çš„å€¼â€</li></ul><h3 id="3-2-Cocotb-Python-æµ‹è¯•ä»£ç è®²è§£"><a href="#3-2-Cocotb-Python-æµ‹è¯•ä»£ç è®²è§£" class="headerlink" title="3.2 Cocotb Python æµ‹è¯•ä»£ç è®²è§£"></a>3.2 Cocotb Python æµ‹è¯•ä»£ç è®²è§£</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> cocotb</span><br><span class="line"><span class="keyword">from</span> cocotb.clock <span class="keyword">import</span> Clock</span><br><span class="line"><span class="keyword">from</span> cocotb.triggers <span class="keyword">import</span> FallingEdge</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="meta">@cocotb.test()</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">test_dff_simple</span>(<span class="params">dut</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;éªŒè¯ d èƒ½æ­£ç¡®ä¼ é€’åˆ° q&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    logger = logging.getLogger(<span class="string">&quot;my_testbench&quot;</span>)</span><br><span class="line">    logger.setLevel(logging.DEBUG)</span><br><span class="line"></span><br><span class="line">    clock = Clock(dut.clk, <span class="number">10</span>, unit=<span class="string">&quot;us&quot;</span>)</span><br><span class="line">    cocotb.start_soon(clock.start())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        val = random.randint(<span class="number">0</span>, <span class="number">7</span>)</span><br><span class="line">        dut.d.value = val</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> FallingEdge(dut.clk)</span><br><span class="line"></span><br><span class="line">        logger.info(<span class="string">f&quot;å‘¨æœŸ <span class="subst">&#123;i&#125;</span>: d=<span class="subst">&#123;dut.d.value&#125;</span>, q=<span class="subst">&#123;dut.q.value&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> dut.q.value == val, <span class="string">f&quot;ç¬¬ <span class="subst">&#123;i&#125;</span> æ¬¡æ£€æŸ¥å¤±è´¥ï¼šæœŸæœ› <span class="subst">&#123;val&#125;</span>ï¼Œå®é™… <span class="subst">&#123;dut.q.value&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure><p>é‡ç‚¹ï¼š</p><ul><li><code>@cocotb.test()</code>ï¼šå£°æ˜ Python æµ‹è¯•ç”¨ä¾‹</li><li><code>Clock(...)</code>ï¼šåœ¨ Python ä¾§åˆ›å»ºæ—¶é’Ÿå¹¶é©±åŠ¨ DUT</li><li><code>await FallingEdge(...)</code>ï¼šäº‹ä»¶é©±åŠ¨å¼ä»¿çœŸ</li><li><code>.value</code> æ˜¯ cocotb å†™å…¥å’Œè¯»å–ä¿¡å·çš„æ ‡å‡†æ–¹å¼</li><li>æ–­è¨€é”™è¯¯ä¼šè‡ªåŠ¨æ ‡çº¢ä¸­æ­¢</li></ul><h3 id="3-3-Makefile-æ ¸å¿ƒéƒ¨åˆ†è§£é‡Š"><a href="#3-3-Makefile-æ ¸å¿ƒéƒ¨åˆ†è§£é‡Š" class="headerlink" title="3.3 Makefile æ ¸å¿ƒéƒ¨åˆ†è§£é‡Š"></a>3.3 Makefile æ ¸å¿ƒéƒ¨åˆ†è§£é‡Š</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> PYTHONPATH := <span class="variable">$(PWD)</span>/testbench:<span class="variable">$(PYTHONPATH)</span></span><br><span class="line">TOPLEVEL_LANG = verilog</span><br><span class="line">VERILOG_SOURCES = <span class="variable">$(PWD)</span>/src/dff.sv</span><br><span class="line">TOPLEVEL = dff</span><br><span class="line">MODULE = test_dff</span><br><span class="line">SIM ?= verilator</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$(<span class="built_in">shell</span> cocotb-config --makefiles)</span>/Makefile.sim</span><br></pre></td></tr></table></figure><p>ç®€è¦è¯´æ˜ï¼š</p><ul><li><code>TOPLEVEL</code> å¿…é¡»ä¸ Verilog ä¸­çš„æ¨¡å—åä¸€è‡´</li><li><code>MODULE=test_dff</code> æŒ‡å®š Python æµ‹è¯•å…¥å£</li><li><code>VERILOG_SOURCES</code> å†³å®šå‚ä¸ä»¿çœŸçš„ RTL æ–‡ä»¶</li><li><code>cocotb-config</code> è‡ªåŠ¨é€‰æ‹©æ­£ç¡®çš„ä»¿çœŸå™¨åç«¯</li></ul><blockquote><p><strong>æ¢æ¨¡å—æ—¶ï¼Œåªéœ€æ”¹ï¼š</strong><br><code>src/*.sv</code>ã€<code>TOPLEVEL</code>ã€<code>MODULE</code>ï¼Œå…¶ä½™é€»è¾‘æ— éœ€ä¿®æ”¹ã€‚</p></blockquote><h2 id="4-å°ç»“"><a href="#4-å°ç»“" class="headerlink" title="4. å°ç»“"></a>4. å°ç»“</h2><p>æœ¬ç¯‡ç¤ºä¾‹å±•ç¤ºäº† Cocotb æœ€å°å¯è¿è¡Œå·¥ç¨‹çš„ç»“æ„å’ŒåŸç†ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>Verilator + Cocotb çš„ååŒä»¿çœŸæµç¨‹</li><li>Verilog DUT çš„æ„æˆ</li><li>Python å¼‚æ­¥ testbench çš„å†™æ³•</li><li>Makefile å¦‚ä½•å°†ä¸¤è€…ä¸²è”</li></ul><p>åç»­ç¯‡ç« å°†ç»§ç»­æ›´æ–°ï¼š</p><ul><li>å¦‚ä½•åˆ©ç”¨ Python æŠŠä»¿çœŸç»“æœè½¬æ¢ä¸ºå¯è§†åŒ–å›¾è¡¨</li><li>å¦‚ä½•è®© Cocotb é€šè¿‡ ModelSim æ”¯æŒå¸¦ Vivado IP çš„ä»¿çœŸ</li></ul>]]></content>
    
    
    <summary type="html">åŸºäº Verilator ä¸ Cocotb å¯¹ Verilog æ¨¡å—è¿›è¡ŒååŒä»¿çœŸçš„åŸºç¡€æµç¨‹ä¸åŸç†è®²è§£</summary>
    
    
    
    
    <category term="cocotb" scheme="https://djdgctw.github.io/tags/cocotb/"/>
    
    <category term="verilog" scheme="https://djdgctw.github.io/tags/verilog/"/>
    
  </entry>
  
</feed>
