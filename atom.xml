<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>djdgctw çš„ç¡¬ä»¶ç¬”è®°</title>
  
  <subtitle>FPGA Â· Verilog Â· HDMI Â· SpinalHDL</subtitle>
  <link href="https://djdgctw.github.io/atom.xml" rel="self"/>
  
  <link href="https://djdgctw.github.io/"/>
  <updated>2025-11-25T01:07:19.547Z</updated>
  <id>https://djdgctw.github.io/</id>
  
  <author>
    <name>djdgctw</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>HDMI1.4åè®®é˜…è¯»ç¬”è®°</title>
    <link href="https://djdgctw.github.io/2025/11/24/HDMI1.4%E5%8D%8F%E8%AE%AE%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"/>
    <id>https://djdgctw.github.io/2025/11/24/HDMI1.4%E5%8D%8F%E8%AE%AE%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/</id>
    <published>2025-11-24T06:30:00.000Z</published>
    <updated>2025-11-25T01:07:19.547Z</updated>
    
    <content type="html"><![CDATA[<h1 id="HDMIä¼ è¾“ç³»ç»Ÿç»¼è¿°"><a href="#HDMIä¼ è¾“ç³»ç»Ÿç»¼è¿°" class="headerlink" title="HDMIä¼ è¾“ç³»ç»Ÿç»¼è¿°"></a>HDMIä¼ è¾“ç³»ç»Ÿç»¼è¿°</h1><p>ä¸€ä¸ªHDMIä¼ è¾“ç³»ç»ŸåŒ…æ‹¬å‘é€ç«¯ï¼ˆsourceï¼‰å’Œæ¥æ”¶ç«¯ï¼ˆsinkï¼‰ã€‚HDMIçº¿ç¼†åŒ…æ‹¬ä»¥ä¸‹è¿æ¥ï¼š</p><ul><li>ç”±å››ä¸ªå·®åˆ†å¯¹ç»„æˆçš„ä¸»æ•°æ®é€šè·¯ï¼ŒåŒ…æ‹¬ä¸‰ä¸ªæ•°æ®é€šé“å’Œä¸€ä¸ªæ—¶é’Ÿé€šé“ã€‚</li><li>VESA DDCï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªI2C busï¼Œç”¨äºé…ç½®å’ŒçŠ¶æ€ä¿¡æ¯çš„ä¼ è¾“</li><li>CECï¼ˆoptionalï¼‰ï¼Œæ¶ˆè´¹ç”µå­æ§åˆ¶</li><li>HEACï¼Œå®¶åº­å½±é™¢ç³»ç»Ÿä¸­éŸ³é¢‘å›ä¼ åŠŸèƒ½</li><li>HPDï¼Œçƒ­æ’æ‹”æ£€æµ‹<br><img src="/img/02_HDMI/HDMI%E6%A1%86%E6%9E%B6%E5%9B%BE.png" alt="HDMIæ¡†æ¶å›¾"><br>HDMIç‰©ç†å±‚çš„å®ç°ä¸åœ¨æ­¤æ¬¡èµ˜è¿°ï¼Œä¸‹é¢ç›´æ¥è¿›å…¥HDMIçš„æ•°æ®é“¾è·¯å±‚ã€‚</li></ul><h2 id="HDMIä¿¡å·ç¼–ç "><a href="#HDMIä¿¡å·ç¼–ç " class="headerlink" title="HDMIä¿¡å·ç¼–ç "></a>HDMIä¿¡å·ç¼–ç </h2><p>HDMI é“¾æ¥ä»¥ä¸‰ç§æ¨¡å¼ä¹‹ä¸€è¿è¡Œï¼šä»»ä½•ä¸¤ä¸ªä¸æ˜¯æ§åˆ¶å‘¨æœŸçš„å‘¨æœŸä¹‹é—´éœ€è¦ä¸€ä¸ªæ§åˆ¶å‘¨æœŸã€‚<br>HDMIä¸€å…±æœ‰ä¸‰ç§ä¼ è¾“æ¨¡å¼ï¼šControl Periodä¼ è¾“control dataï¼›Data Island Periodä¼ è¾“packet dataï¼›Video Data Periodä¼ è¾“video dataã€‚</p><ul><li>ControlPeriod æ§åˆ¶å‘¨æœŸï¼šä¸»è¦ç”¨äºæ§åˆ¶æ¥ä¸‹æ¥ä¼ è¾“çš„æ˜¯dataisland è¿˜æ˜¯ videodataï¼›<br>åŒæ­¥ä¿¡å·HSYNCå’ŒVSYNCä¼šåœ¨ç‰¹å®šçš„è¡Œã€åˆ—ä½ç½®æ‹‰èµ·ï¼Œç”¨äºsourceå’Œsinkä¹‹é—´çš„åŒæ­¥ã€‚å¯ä»¥çœ‹åˆ°å®é™…ä¼ è¾“çš„å¸§å¤§å°æ˜¯è¦å¤§äºè§†é¢‘å¤§å°ï¼ˆ720*480pï¼‰ï¼ŒåŒ…æ‹¬é¢å¤–æ’å…¥äº†ä¸€äº›è¡Œï¼Œå¹¶ä¸”è¡Œçš„é•¿åº¦ä¹Ÿå¾—åˆ°äº†æ‰©å±•ï¼Œè¿™äº›æ‰©å±•çš„åŒºåŸŸè¢«ç§°ä¸ºblankåŒºï¼ˆåŒ…æ‹¬Vblankå’ŒHblankï¼‰ï¼ŒblankåŒºç”±Control Periodå’ŒData Island Periodäº¤æ›¿å¡«å……ï¼Œå…¶ä¸­åœ¨Data Island Periodä¼šä¼ è¾“éŸ³é¢‘æ•°æ®å’Œå…¶ä»–è¾…åŠ©æ•°æ®ï¼ˆä¾‹å¦‚åƒç´ æ ¼å¼ç­‰ï¼‰ã€‚å®é™…ä¼ è¾“Video Data Periodçš„åŒºåŸŸç§°ä¸ºactiveåŒºï¼Œä¼ è¾“æˆ‘ä»¬æœ€ç»ˆä¼šåœ¨æ˜¾ç¤ºå™¨ä¸Šçœ‹åˆ°çš„è§†é¢‘å›¾åƒæ•°æ®ã€‚<br><img src="/img/02_HDMI/02.png" alt="æ˜¾ç¤ºæ—¶åºå›¾"><br>åœ¨HDMI clock channelä¸Šæ¯ä¸€æ‹æ—¶é’Ÿï¼ˆåˆç§°ä¸ºä¸€ä¸ªTMDS Clockï¼‰ï¼Œæ¯ä¸ªdata channelä¸Šéƒ½ä¼šä¼ è¾“10bitçš„characterã€‚è¿™10bitçš„characterï¼Œå¯¹äºä¸åŒçš„æ•°æ®ï¼Œç”±ä¸åŒçš„ç¼–ç æ–¹å¼å¾—åˆ°ï¼š</li><li>control dataï¼š2 bit -&gt; 10 bitç¼–ç </li><li>packet dataï¼š4 bit -&gt; 10 bitç¼–ç ï¼ˆTERC4ç¼–ç ï¼‰</li><li>video dataï¼š8 bit -&gt; 10 bitç¼–ç ï¼ˆTMDSç¼–ç ï¼‰</li></ul><p>æ¢å¥è¯è¯´ï¼Œæ¯ä¸ªTMDS Clockï¼Œåœ¨æ¯ä¸ªdata channelä¸Šï¼Œä¼šä¼ è¾“2bitçš„control dataï¼Œæˆ–è€…4bitçš„packet dataï¼Œæˆ–è€…10bitçš„control dataã€‚<br><img src="/img/02_HDMI/03.png" alt="ä¿¡å·ä¼ è¾“æ¡†æ¶"></p><h3 id="è§†é¢‘æ•°æ®ä¼ è¾“æœŸï¼ˆVideo-Data-Periodï¼‰"><a href="#è§†é¢‘æ•°æ®ä¼ è¾“æœŸï¼ˆVideo-Data-Periodï¼‰" class="headerlink" title="è§†é¢‘æ•°æ®ä¼ è¾“æœŸï¼ˆVideo Data Periodï¼‰"></a>è§†é¢‘æ•°æ®ä¼ è¾“æœŸï¼ˆVideo Data Periodï¼‰</h3><p>åœ¨ Video Data Period å†…ï¼ŒHDMI æ•°æ®é€šé“ä¼ è¾“çš„æ˜¯è§†é¢‘åƒç´ æ•°æ®ã€‚<br>å…¸å‹è§†é¢‘åƒç´ ä¸º 24bitï¼ˆ8bit Ã— R&#x2F;G&#x2F;Bï¼‰ï¼Œåˆ†åˆ«è¿›å…¥ 3 è·¯ TMDS é€šé“ï¼ˆData0ã€Data1ã€Data2ï¼‰ã€‚</p><p>æ¯ä¸ª TMDS é€šé“ä¼šå°† 8bit åƒç´ æ•°æ® TMDS ç¼–ç æˆ 10bitï¼Œç¼–ç å®Œæˆåï¼š</p><p>æ¯ä¸ª TMDS æ—¶é’Ÿå‘¨æœŸï¼ˆTMDS Clock &#x3D; Pixel Clockï¼‰</p><p>æ¯ä¸ªæ•°æ®é€šé“ä¼ è¾“ä¸€ä¸ª 10bit TMDS character</p><p>ä¸‰ä¸ªé€šé“å…±åŒå®Œæˆä¸€ç»„åƒç´ çš„ä¼ è¾“</p><p>æœ€ç»ˆåœ¨æ¥æ”¶ç«¯ï¼ŒTMDS è§£ç åæ¢å¤ä¸º 24bit çš„ R&#x2F;G&#x2F;B åƒç´ ã€‚</p><h3 id="æ•°æ®åŒ…ä¼ è¾“æœŸï¼ˆData-Island-Periodï¼‰"><a href="#æ•°æ®åŒ…ä¼ è¾“æœŸï¼ˆData-Island-Periodï¼‰" class="headerlink" title="æ•°æ®åŒ…ä¼ è¾“æœŸï¼ˆData Island Periodï¼‰"></a>æ•°æ®åŒ…ä¼ è¾“æœŸï¼ˆData Island Periodï¼‰</h3><p>åœ¨ Data Island Period ä¸­ï¼ŒHDMI é€šé“ä¸ä¼ è¾“è§†é¢‘åƒç´ ï¼Œè€Œæ˜¯æ‰¿è½½ï¼šéŸ³é¢‘æ•°æ®ï¼ˆAudio Sampleï¼‰ã€è¾…åŠ©æ•°æ®ï¼ˆAVI InfoFrameã€Vendor InfoFrame ç­‰ï¼‰ï¼Œè¿™äº›æ•°æ®ä»¥ 4bit ä¸ºå•ä½ï¼Œç§°ä¸º TERC4 groupã€‚<br>æµç¨‹å¦‚ä¸‹ï¼šData Island çš„åŸå§‹æ•°æ®è¢«æ‹†åˆ†æˆ 4bit group,æ¯ç»„ 4bit ç»è¿‡ TERC4 ç¼–ç  â†’ 10bit,ä¸‰ä¸ªé€šé“ç»§ç»­ä¿æŒ TMDS æ—¶é’ŸåŒæ­¥ä¼ è¾“,æ¥æ”¶ç«¯è¯†åˆ« GuardBand â†’ è¯†åˆ« Data Island â†’ è§£ç  TERC4<br>ä¸ Video Data ç±»ä¼¼ï¼Œæ¯ä¸ª TMDS Clock éƒ½ä¼šåœ¨æ¯ä¸ªé€šé“ä¸Šä¼  10bitï¼Œä½†è¿™äº› 10bit æ˜¯ç”± TERC4 äº§ç”Ÿçš„ã€‚</p><h3 id="GuardBandï¼ˆä¿æŠ¤é¢‘å¸¦ï¼‰"><a href="#GuardBandï¼ˆä¿æŠ¤é¢‘å¸¦ï¼‰" class="headerlink" title="GuardBandï¼ˆä¿æŠ¤é¢‘å¸¦ï¼‰"></a>GuardBandï¼ˆä¿æŠ¤é¢‘å¸¦ï¼‰</h3><p>æ— è®ºæ˜¯ï¼š<br>Video Data Period â†’ Control Period<br>Control Period â†’ Data Island Period<br>Data Island Period â†’ Video Data Period<br>HDMI éƒ½å¿…é¡»ä½¿ç”¨ GuardBand æ¥æ ‡è®°ä¼ è¾“åŒºé—´çš„è¾¹ç•Œã€‚<br>GuardBand ç”± ä¸¤ä¸ªç‰¹æ®Š TMDS å­—ç¬¦ç»„æˆï¼Œå…¶è®¾è®¡ç›®çš„ï¼š</p><ul><li>æ¸…æ™°æ ‡è®°å½“å‰å‘¨æœŸç»“æŸ</li><li>æ˜ç¡®æç¤ºæ¥æ”¶ç«¯ï¼šæ¥ä¸‹æ¥æ˜¯ Video è¿˜æ˜¯ Data Island</li><li>é¿å…åŒæ­¥è¿‡ç¨‹ä¸­è¯¯åˆ¤<br>GuardBand åœ¨ HDMI é“¾è·¯çš„æ—¶åºè§£æä¸­æå…¶å…³é”®ã€‚</li></ul><h3 id="æ§åˆ¶æ•°æ®ä¼ è¾“æœŸï¼ˆControl-Periodï¼‰"><a href="#æ§åˆ¶æ•°æ®ä¼ è¾“æœŸï¼ˆControl-Periodï¼‰" class="headerlink" title="æ§åˆ¶æ•°æ®ä¼ è¾“æœŸï¼ˆControl Periodï¼‰"></a>æ§åˆ¶æ•°æ®ä¼ è¾“æœŸï¼ˆControl Periodï¼‰</h3><p>åœ¨ Video ä¸ Data Island ä¹‹é—´ï¼Œæ€»ä¼šæœ‰ Control Periodã€‚<br>åœ¨ Control Period ä¸­ï¼š</p><p>æ¯ä¸ª TMDS é€šé“æºå¸¦å›ºå®šçš„ 2bit control data</p><p>ä¸‰ä¸ªé€šé“å…± 6bit control ä¿¡æ¯</p><p>å…¶æ„æˆå¦‚ä¸‹ï¼š</p><p>é€šé“2bit æ•°æ®å†…å®¹<br>Channel 0HSYNCã€VSYNCï¼ˆè¡Œ&#x2F;åœºåŒæ­¥ä¿¡å·ï¼‰<br>Channel 1CTL0ã€CTL1<br>Channel 2CTL2ã€CTL3</p><p>å…¶ä¸­ï¼š</p><p>HSYNC &#x2F; VSYNC æ˜¯æ˜¾ç¤ºå™¨åŒæ­¥çš„é‡è¦æ ‡å¿—</p><p>CTL0~CTL3 ç”¨äºæŒ‡ç¤ºï¼š<br>ä¸‹ä¸€ä¸ªå‘¨æœŸæ˜¯ Video Data è¿˜æ˜¯ Data Island</p><p>Control Period çš„ TMDS ç¼–ç æ–¹å¼æ˜¯å›ºå®šçš„ï¼š<br>2bit â†’ 10bit çš„ç‰¹æ®Šæ§åˆ¶ç¼–ç ï¼ˆé TMDS 8b10bï¼Œä¹Ÿé TERC4ï¼‰ã€‚</p><h3 id="ä¸‰ç§ä¼ è¾“å‘¨æœŸçš„ç¼–ç æ–¹å¼æ€»ç»“"><a href="#ä¸‰ç§ä¼ è¾“å‘¨æœŸçš„ç¼–ç æ–¹å¼æ€»ç»“" class="headerlink" title="ä¸‰ç§ä¼ è¾“å‘¨æœŸçš„ç¼–ç æ–¹å¼æ€»ç»“"></a>ä¸‰ç§ä¼ è¾“å‘¨æœŸçš„ç¼–ç æ–¹å¼æ€»ç»“</h3><p>ä¸‹è¡¨æ˜¯å„ç§æ•°æ®åœ¨ HDMI ä¸­çš„ç¼–ç ç±»å‹æ¦‚è§ˆï¼š</p><p>ä¼ è¾“é˜¶æ®µåŸå§‹æ•°æ®ä½å®½ç¼–ç æ–¹å¼è¾“å‡º TMDS å®½åº¦<br>Control Period2 bitControl Encoding10 bit<br>Data Island Period4 bitTERC4 (4â†’10 ç¼–ç )10 bit<br>Video Data Period8 bitTMDS 8â†’10 ç¼–ç 10 bit<br>GuardBand å›ºå®šç¼–ç <br>æ¢å¥è¯è¯´ï¼š<br>æ¯ä¸ª TMDS Clockï¼ŒHDMI æ¯æ¡æ•°æ®é€šé“å§‹ç»ˆä¼ è¾“ 10bitï¼Œåªæ˜¯ç¼–ç æ–¹å¼ä¸åŒã€‚<br><img src="/img/02_HDMI/17.png" alt="ç¼–ç å›¾"></p><h2 id="Control-Period"><a href="#Control-Period" class="headerlink" title="Control Period"></a>Control Period</h2><p>Control Period åœ¨ HDMI TMDS é“¾è·¯ä¸­ç”¨äºæ‰¿ä¸Šå¯ä¸‹ï¼šæä¾› HSYNC &#x2F; VSYNCï¼ˆåœ¨ Channel 0ï¼‰ã€æä¾› CTL0~CTL3ï¼ˆåœ¨ Channel 1 å’Œ 2ï¼‰ã€<br>é€šè¿‡ä¸€ä¸² ç›¸åŒçš„æ§åˆ¶å­—ç¬¦ï¼ˆPreambleï¼‰ æ˜ç¡®æ¥ä¸‹æ¥è¦è¿›å…¥çš„å‘¨æœŸç±»å‹ï¼š</p><ul><li>Video Data Period</li><li>Data Island Period<br>åœ¨ HDMI 1.4 åè®®ä¸­ï¼ŒCTL0~CTL3 çš„åº”ç”¨åŒ…æ‹¬ï¼š</li><li>Video Data Preambleï¼ˆè§†é¢‘å‘¨æœŸå‰å¯¼ç ï¼‰</li><li>Data Island Preambleï¼ˆæ•°æ®å²›å‘¨æœŸå‰å¯¼ç ï¼‰</li><li>Character Synchronizationï¼ˆå­—ç¬¦åŒæ­¥ï¼‰</li><li>HDCP 1.4 ä¸­çš„ EESS ä¿¡å·ä¼ è¾“</li></ul><h3 id="Preambleï¼ˆå‰å¯¼ç ï¼‰"><a href="#Preambleï¼ˆå‰å¯¼ç ï¼‰" class="headerlink" title="Preambleï¼ˆå‰å¯¼ç ï¼‰"></a>Preambleï¼ˆå‰å¯¼ç ï¼‰</h3><p>åœ¨æ¯ä¸ª Video Data Period æˆ– Data Island Period ä¹‹å‰ï¼Œéƒ½ä¼šæ’å…¥ä¸€ä¸ª Control Period åºåˆ—ï¼ˆPreambleï¼‰ã€‚<br>è¯¥åºåˆ—ç”± 8 ä¸ªç›¸åŒçš„ TMDS æ§åˆ¶å­—ç¬¦ç»„æˆï¼Œç”¨äº é€šçŸ¥æ¥æ”¶ç«¯ä¸‹ä¸€ä¸ªæ•°æ®å‘¨æœŸçš„ç±»å‹ã€‚<br><img src="/img/02_HDMI/05.png"><br>åœ¨å‰å¯¼ç æœŸé—´ï¼š<br>Channel 0 çš„ HSYNC å’Œ VSYNC æŒ‰å®é™…è¡Œåœºæ—¶åºç»§ç»­ä¼ è¾“ï¼ˆä¸ä¼šæš‚åœï¼‰<br>Channel 1 å’Œ Channel 2 çš„ CTL0~CTL3 ç”¨äºæŒ‡ç¤ºæ¥ä¸‹æ¥çš„å‘¨æœŸç±»å‹<br><img src="/img/02_HDMI/06.png"></p><h3 id="Preamble-çš„å‘¨æœŸç±»å‹åˆ¤å®šï¼ˆCTL0-CTL3ï¼‰"><a href="#Preamble-çš„å‘¨æœŸç±»å‹åˆ¤å®šï¼ˆCTL0-CTL3ï¼‰" class="headerlink" title="Preamble çš„å‘¨æœŸç±»å‹åˆ¤å®šï¼ˆCTL0~CTL3ï¼‰"></a>Preamble çš„å‘¨æœŸç±»å‹åˆ¤å®šï¼ˆCTL0~CTL3ï¼‰</h3><p>HDMI è§„å®š åªæœ‰ä¸¤ç§åˆæ³•çš„ Preamble æ§åˆ¶å­—ç¬¦ç»„åˆï¼Œç”¨äºè¡¨ç¤ºä¸‹ä¸€ä¸ªæ•°æ®å‘¨æœŸçš„ç±»å‹ï¼š<br>CTL0CTL1CTL2CTL3æ•°æ®å‘¨æœŸç±»å‹<br>1000Video Data Periodï¼ˆè§†é¢‘æ•°æ®å‘¨æœŸï¼‰<br>1010Data Island Periodï¼ˆæ•°æ®å²›å‘¨æœŸï¼‰<br>è§£é‡Šå¦‚ä¸‹ï¼š<br>CTL &#x3D; 1000<br>â†’ è¡¨ç¤ºä¸‹ä¸€ä¸ªå‘¨æœŸæ˜¯ Video Data Period<br>â†’ éšåè¿›å…¥ Video Guard Band å†å¼€å§‹ä¼ è¾“è§†é¢‘æ•°æ®<br>CTL &#x3D; 1010<br>â†’ è¡¨ç¤ºä¸‹ä¸€ä¸ªå‘¨æœŸæ˜¯ Data Island Period<br>â†’ éšåè¿›å…¥ Data Island Guard Band å†å¼€å§‹ä¼ è¾“éŸ³é¢‘æˆ–è¾…åŠ©æ•°æ®</p><h3 id="Guard-Band-ä¸-Data-Period-å¼€å§‹çš„æ ‡è¯†"><a href="#Guard-Band-ä¸-Data-Period-å¼€å§‹çš„æ ‡è¯†" class="headerlink" title="Guard Band ä¸ Data Period å¼€å§‹çš„æ ‡è¯†"></a>Guard Band ä¸ Data Period å¼€å§‹çš„æ ‡è¯†</h3><p>Preamble ç»“æŸåï¼ŒTMDS é“¾è·¯ä¼šå‘é€ Guard Bandï¼ˆä¿æŠ¤å¸¦ï¼‰ï¼š<br>Video Guard Bandï¼šæ ‡è¯†è§†é¢‘æ•°æ®å³å°†åˆ°æ¥<br>Data Island Guard Bandï¼šæ ‡è¯†æ•°æ®å²›å³å°†åˆ°æ¥<br>æ¥æ”¶ç«¯é€šè¿‡ â€œå‰å¯¼ç  â†’ GuardBand çš„è½¬æ¢â€ æ˜ç¡®è¯†åˆ« Data Periodï¼ˆæ•°æ®å‘¨æœŸï¼‰çš„å¼€å§‹ã€‚<br>æ¢å¥è¯è¯´ï¼š<br>Preamble å†³å®šå‘¨æœŸç±»å‹ï¼ŒGuardBand å†³å®šå‘¨æœŸå¼€å§‹ã€‚<br>âš ï¸ æ³¨æ„ï¼šData Island Preamble çš„é™åˆ¶<br>åè®®è¦æ±‚ï¼š<br>CTL &#x3D; 1010ï¼ˆData Island Preambleï¼‰ä¸å¾—åœ¨é Preamble æ—¶åˆ»å‘é€ã€‚<br>å¦åˆ™ä¼šå¯¼è‡´æ¥æ”¶ç«¯é”™è¯¯åœ°è®¤ä¸ºä¸€ä¸ª Data Island å‘¨æœŸå³å°†åˆ°æ¥ï¼Œå› æ­¤ HDMI å‘å°„ç«¯å¿…é¡»ä¸¥æ ¼ç¡®ä¿ï¼šä»…åœ¨åˆæ³• Preamble æ—¶åˆ»å‘é€ 1010 æ§åˆ¶å­—ç¬¦ï¼Œå…¶ä»– Control Period ä¸­ä¸å¾—å‡ºç°è¯¥ç»„åˆ</p><h2 id="Data-Island-Period-å’Œ-Video-Data-Period-çš„ä¼ è¾“è§„åˆ™"><a href="#Data-Island-Period-å’Œ-Video-Data-Period-çš„ä¼ è¾“è§„åˆ™" class="headerlink" title="Data Island Period å’Œ Video Data Period çš„ä¼ è¾“è§„åˆ™"></a>Data Island Period å’Œ Video Data Period çš„ä¼ è¾“è§„åˆ™</h2><h3 id="Data-Island-Period"><a href="#Data-Island-Period" class="headerlink" title="Data Island Period"></a>Data Island Period</h3><ul><li>ç´§è´´Data Island Periodä¼ è¾“çš„å‰åï¼Œåˆ†åˆ«æœ‰ä¸€ä¸ªData Island Guard Bandï¼ˆç§°ä¸ºLeading Guard Bandå’ŒTrailing Guard Bandï¼‰ï¼Œé•¿åº¦å‡ä¸º2ä¸ªTMDS Clockã€‚</li><li>åœ¨Leading Data Island Guard Bandå‰é¢ï¼Œæœ‰ä¸€ä¸ªData Island Preambleï¼Œé•¿åº¦ä¸º8ä¸ªTMDS Clockã€‚</li><li>ç”±äºHDMI1.4åè®®è§„å®šï¼Œæ¯æ¬¡å‘Control Periodå¿…é¡»è¿ç»­å‘è‡³å°‘12ä¸ªTMDS Clockã€‚ç”±äºData Island Preambleè¢«è§†ä¸ºä¸€ç§ç‰¹æ®Šçš„Control Periodï¼Œå› æ­¤åœ¨Data Island Preambleå‰é¢ä¼šæœ‰è‡³å°‘è¿ç»­4 TMDS Clockçš„Control Periodã€‚</li><li>åœ¨ä¸¤ä¸ªData Island Guard BandåŒ…å›´èµ·æ¥çš„ä¸­é—´åŒºåŸŸï¼Œä¼šå‘é€å®é™…çš„packet dataã€‚æ¯ä¸€ä¸ªpacketéœ€è¦32ä¸ªTMDS Clockï¼Œå¯ä»¥è¿ç»­å‘é€æœ€å°‘1ä¸ªï¼Œæœ€å¤š18ä¸ªpacketã€‚å› æ­¤æ¯ä¸€ä¸ªData Island Periodçš„æœ€å°é•¿åº¦ä¸º1Ã—32 + 2Ã—2 &#x3D; 36 TMDS Clockï¼ˆå¤´å°¾çš„ä¸¤ä¸ªGuard Bandä¹Ÿæ˜¯Data Island Periodçš„ä¸€éƒ¨åˆ†ï¼‰ã€‚</li></ul><h3 id="Video-Data-Period"><a href="#Video-Data-Period" class="headerlink" title="Video Data Period"></a>Video Data Period</h3><ul><li>ä¸Data Island Periodç±»ä¼¼ï¼Œæœ‰ä¸€ä¸ªé•¿åº¦ä¸º2 TMDS Clockçš„Video Data Guard Bandï¼Œä½†ä»…å­˜åœ¨äºVideo Data Periodä¼ è¾“æœ€å¼€å§‹ï¼ˆä¹Ÿå³åªæœ‰Leading Guard Bandï¼‰ã€‚</li><li>åŒæ ·æœ‰ä¸€ä¸ªé•¿åº¦ä¸º8 TMDS Clockçš„Video Data Preambleã€‚</li><li>Video Data Preambleå‰é¢åŒæ ·ä¼šæœ‰è‡³å°‘è¿ç»­4 TMDS Clockçš„Control Periodã€‚</li><li>Data Island Periodå’ŒVideo Data Periodä¸èƒ½ç´§è´´ï¼Œæ— è®ºå“ªä¸€ä¸ªåœ¨å‰ï¼Œåœ¨å‰è€…ä¼ è¾“å®Œæˆåå¿…é¡»ä¼ è¾“ä¸€æ®µControl Periodï¼Œæ‰èƒ½ä¼ è¾“åè€…ã€‚<br><img src="/img/02_HDMI/04.png" alt="TMDS Period AND Encode"></li></ul><h3 id="Character-Synchronization"><a href="#Character-Synchronization" class="headerlink" title="Character Synchronization"></a>Character Synchronization</h3><ul><li>TMDS Characteræ˜¯æŒ‡æ¯æ¬¡ç¼–ç åï¼Œæ¯ä¸ªTMDS Clockä¼ è¾“çš„10 bitå€¼ã€‚</li><li>ç»è¿‡ç¼–ç åï¼ŒVideo Data Periodå’ŒData Island Periodçš„æ¯ä¸ªcharacterä¼šåŒ…å«5æ¬¡æˆ–è€…æ›´å°‘çš„1-&gt;0æˆ–0-&gt;1è·³è½¬ï¼Œè€ŒControl Periodä¼šåŒ…å«7æ¬¡æˆ–æ›´å¤šçš„è·³è½¬ã€‚</li><li>åŸºäºæ­¤ï¼Œsourceç«¯çš„æ¯æ¬¡Control Periodéœ€è¦æŒç»­12ä¸ªTMDS Clocksï¼Œè€Œsinkç«¯çš„è§£ç å™¨åº”è¯¥èƒ½è¯†åˆ«åˆ°è¿™æ ·è¿ç»­çš„Contral Periodä¼ è¾“ï¼Œä»è€ŒåŒæ­¥åˆ°Characterè¾¹ç•Œã€‚Sinkç«¯çš„æ£€æµ‹ç®—æ³•å®ç°ç”±å…¶è‡ªè¡Œå†³å®šï¼Œä¸åœ¨HDMI1.4åè®®ä¸­åšè¦æ±‚ã€‚<br><img src="/img/02_HDMI/07.png"></li><li>æ¯éš”ä¸€å®šæ—¶é—´é—´éš”ï¼ˆè‡³å°‘50æ¯«ç§’ä¸€æ¬¡ï¼‰ï¼Œsourceç«¯è¿˜è¢«è¦æ±‚è¦å‘ä¸€ä¸ªæŒç»­æ—¶é—´æ›´é•¿ï¼ˆ32 TMDS Clocksï¼‰çš„Control Periodï¼Œè¢«ç§°ä¸ºExtended Control Periodã€‚<br><img src="/img/02_HDMI/08.png"></li></ul><h3 id="Control-Period-Encoding"><a href="#Control-Period-Encoding" class="headerlink" title="Control Period Encoding"></a>Control Period Encoding</h3><p><img src="/img/02_HDMI/09.png"></p><h2 id="Data-Island-Period-1"><a href="#Data-Island-Period-1" class="headerlink" title="Data Island Period"></a>Data Island Period</h2><p>å¯¹äºData Island Periodï¼ˆåŒ…æ‹¬å¯¹åº”çš„Guard Bandï¼‰çš„ä¼ è¾“ï¼š</p><ul><li>ä¸‹é¢æŒ‡ä»£çš„æ˜¯[3:0]é•¿åº¦çš„é‚£ä¸ªä¿¡å·</li><li>channel 0ä¸­çš„D0å’ŒD1åˆ†åˆ«ä¼ è¾“HSYNC å’ŒVSYNC</li><li>D2ä¼ è¾“Packet Headerï¼ˆåœ¨Guard BandåŒºåŸŸå›ºå®šä¼ è¾“1ï¼‰</li><li>D3åœ¨Leading Guard Bandåçš„ç¬¬ä¸€ä¸ªTMDS Clockä¼ è¾“0ï¼Œåœ¨å…¶ä»–TMDS Clockï¼ˆåŒ…æ‹¬Guard Bandï¼‰ä¼ è¾“</li><li>channel 1å’Œchannel 2çš„æ€»è®¡8bitç”¨äºä¼ è¾“Packet Dataï¼ˆGuard BandåŒºåŸŸä¼šä¼ è¾“å›ºå®šçš„10 bits characterï¼‰</li></ul><h3 id="Data-Island-Guard-Band"><a href="#Data-Island-Guard-Band" class="headerlink" title="Data Island Guard Band"></a>Data Island Guard Band</h3><ul><li>Data Island Guard Bandæ—¶ï¼Œchannel 1å’Œchannel 2è¢«ç›´æ¥ç¼–ç ä¸ºå®é™…HDMI Laneä¸Šå›ºå®šçš„10 bit Characterï¼Œå…¶å€¼å¦‚ä¸‹å›¾ï¼Œå…¶ä¸­channel0ç”±ç¼–è¯‘è§„åˆ™å†³å®šï¼ŒNAå®é™…ä¸Šæ˜¯ä¸ç¡®å®šçš„æ„æ€<br><img src="/img/02_HDMI/10.png" alt="Data Island Guard Bandæ—¶,channel1,2ç¼–ç åå›ºå®šå€¼"></li><li>channel 0ä¸Šï¼ŒD2å’ŒD3è¢«å›ºå®šä¸º1ï¼Œå› æ­¤ï¼Œä¾æ®HSYNCå’ŒVSYNCçš„å–å€¼ï¼Œchannel 0ä¸ŠD[3:0]å¯èƒ½çš„å–å€¼ä¸º0xCï¼Œ0xDï¼Œ0xEï¼Œ0xFï¼Œå¹¶é€šè¿‡TERC4ç¼–ç ä¸º10bit character</li></ul><h3 id="Data-Island-Packetï¼ˆæ•°æ®å²›åŒ…ï¼‰ç»“æ„è¯´æ˜"><a href="#Data-Island-Packetï¼ˆæ•°æ®å²›åŒ…ï¼‰ç»“æ„è¯´æ˜" class="headerlink" title="Data Island Packetï¼ˆæ•°æ®å²›åŒ…ï¼‰ç»“æ„è¯´æ˜"></a>Data Island Packetï¼ˆæ•°æ®å²›åŒ…ï¼‰ç»“æ„è¯´æ˜</h3><p>åœ¨ HDMI Data Island Period ä¸­ï¼Œæ‰€æœ‰éŸ³é¢‘åŒ…å’Œ InfoFrame è¾…åŠ©æ•°æ®éƒ½ä»¥ <strong>Packet</strong> çš„å½¢å¼ä¼ è¾“ã€‚<br>æ¯ä¸€ä¸ª Packet å ç”¨ <strong>32 ä¸ª TMDS Clocks</strong>ï¼Œç”±ä»¥ä¸‹ä¸¤å¤§éƒ¨åˆ†ç»„æˆï¼š</p><ol><li><strong>Packet Headerï¼ˆåŒ…å¤´ï¼‰</strong>  </li><li><strong>Packet Bodyï¼ˆåŒ…å« 4 ä¸ª Subpacket çš„åŒ…ä½“ï¼‰</strong></li></ol><p>æ¯ä¸ªéƒ¨åˆ†éƒ½åŒ…å«å¯¹åº”çš„ <strong>BCH çº é”™ä½ï¼ˆECCï¼‰</strong>ã€‚</p><h4 id="1-Packet-Headerï¼ˆ24bit-æ•°æ®-8bit-BCH-æ ¡éªŒï¼‰"><a href="#1-Packet-Headerï¼ˆ24bit-æ•°æ®-8bit-BCH-æ ¡éªŒï¼‰" class="headerlink" title="1. Packet Headerï¼ˆ24bit æ•°æ® + 8bit BCH æ ¡éªŒï¼‰"></a>1. Packet Headerï¼ˆ24bit æ•°æ® + 8bit BCH æ ¡éªŒï¼‰</h4><p>Packet Header å…± 24bitï¼Œç”± 3 ä¸ª Header Bytesï¼ˆHB0ã€HB1ã€HB2ï¼‰ç»„æˆã€‚<br>æ ¹æ® HDMI è§„èŒƒï¼Œéœ€ä¸º Header æ·»åŠ  <strong>8bit çš„ BCH(32,24) æ ¡éªŒä½</strong>ï¼Œæ„æˆ <strong>32bit çš„ BCH Block4</strong>ã€‚<br><strong>è¯¥ BCH Block4 é€šè¿‡ Channel 0 çš„ D2 çº¿ä¸Šä¼ è¾“ã€‚</strong></p><h4 id="2-Packet-Bodyï¼ˆ4-ä¸ª-Subpacketï¼‰"><a href="#2-Packet-Bodyï¼ˆ4-ä¸ª-Subpacketï¼‰" class="headerlink" title="2. Packet Bodyï¼ˆ4 ä¸ª Subpacketï¼‰"></a>2. Packet Bodyï¼ˆ4 ä¸ª Subpacketï¼‰</h4><p>Packet Body åŒ…å« <strong>4 ä¸ª Subpacket</strong>ï¼Œæ¯ä¸ª Subpacket åŒ…å«ï¼š</p><ul><li><strong>56 bits æ•°æ®</strong></li><li><strong>8 bits BCH(64,56) æ ¡éªŒä½</strong><br>æ¯ä¸ª Subpacket æ„æˆä¸€ä¸ª BCH Blockï¼ˆBlock0â€“Block3ï¼‰ã€‚<br><strong>è¿™äº› BCH Blocks é€šè¿‡ Channel 1 å’Œ Channel 2 ä¼ è¾“ã€‚</strong></li></ul><h4 id="3-Subpacket-åˆ°-Packet-Bytesï¼ˆPBxï¼‰çš„æ˜ å°„"><a href="#3-Subpacket-åˆ°-Packet-Bytesï¼ˆPBxï¼‰çš„æ˜ å°„" class="headerlink" title="3. Subpacket åˆ° Packet Bytesï¼ˆPBxï¼‰çš„æ˜ å°„"></a>3. Subpacket åˆ° Packet Bytesï¼ˆPBxï¼‰çš„æ˜ å°„</h4><p>æ¯ä¸ª Subpacket çš„ 56bit ç­‰äº <strong>7 ä¸ªå­—èŠ‚</strong>ï¼šSB0, SB1, SB2, SB3, SB4, SB5, SB6<br>4 ä¸ª Subpacket å…± <strong>28 ä¸ªå­—èŠ‚</strong>ï¼ŒHDMI å°†å®ƒä»¬é¡ºåºæ‹¼æ¥ä¸ºï¼šPB0 ~ PB27</p><ul><li>æ˜ å°„å…³ç³»å¦‚ä¸‹ï¼š<table><thead><tr><th>Subpacket</th><th>åŒ…å«å­—èŠ‚</th><th>æ˜ å°„åˆ° PB èŒƒå›´</th></tr></thead><tbody><tr><td>Subpacket0</td><td>SB0â€“SB6</td><td>PB0 â€“ PB6</td></tr><tr><td>Subpacket1</td><td>SB0â€“SB6</td><td>PB7 â€“ PB13</td></tr><tr><td>Subpacket2</td><td>SB0â€“SB6</td><td>PB14 â€“ PB20</td></tr><tr><td>Subpacket3</td><td>SB0â€“SB6</td><td>PB21 â€“ PB27</td></tr></tbody></table></li><li>è¿™ç§è¿ç»­æ˜ å°„æ–¹å¼æ–¹ä¾¿ Sink å¯¹ Packet Body è¿›è¡Œçº¿æ€§è§£æï¼Œä¹Ÿç¬¦åˆ BCH Block æ•°æ®å¸ƒå±€è¦æ±‚ï¼Œè§£ç æ—¶æ ¹æ®è¿™ä¸ªè§£ç ã€‚</li></ul><p>å…³ç³»å›¾å¦‚ä¸‹<br><img src="/img/02_HDMI/11.png" alt="Data Island Guard Bandæ—¶,channel1,2ç¼–ç åå›ºå®šå€¼"></p><h3 id="çº é”™ä½è®¡ç®—ï¼ˆECCï¼‰"><a href="#çº é”™ä½è®¡ç®—ï¼ˆECCï¼‰" class="headerlink" title="çº é”™ä½è®¡ç®—ï¼ˆECCï¼‰"></a>çº é”™ä½è®¡ç®—ï¼ˆECCï¼‰</h3><p>HDMI çš„ Data Island Packet ä½¿ç”¨ BCH çº é”™ç æ¥ä¿æŠ¤ Header ä¸ Subpacket çš„æ•°æ®å®Œæ•´æ€§ã€‚</p><ul><li><strong>BCH(64,56)</strong> ç”¨äº 56bit Subpacket æ•°æ®  </li><li><strong>BCH(32,24)</strong> ç”¨äº 24bit Packet Header æ•°æ®</li></ul><p>çº é”™ä½ç”±æ ‡å‡†çš„ BCH ç”Ÿæˆå¤šé¡¹å¼è®¡ç®—å¾—åˆ°ã€‚<br>å…·ä½“çš„ BCH è®¡ç®—ç»†èŠ‚ä¸åœ¨æ­¤å¤„å±•å¼€ã€‚</p><p><img src="/img/02_HDMI/12.png" alt="Packetçº é”™ä½"></p><h3 id="Packet-Header-å’Œ-Packet-Body-çš„å®šä¹‰"><a href="#Packet-Header-å’Œ-Packet-Body-çš„å®šä¹‰" class="headerlink" title="Packet Header å’Œ Packet Body çš„å®šä¹‰"></a>Packet Header å’Œ Packet Body çš„å®šä¹‰</h3><p>Packet Headerï¼ˆHB0ã€HB1ã€HB2ï¼‰ä»¥åŠ Packet Bodyï¼ˆSubpacket ç»“æ„ï¼‰åœ¨ HDMI1.4 æ•°æ®å²›ç« èŠ‚ä¸­æœ‰è¯¦ç»†å®šä¹‰ã€‚<br>åç»­æ–‡ç« ä¼šç»§ç»­å±•å¼€å…·ä½“ç»“æ„å’Œç±»å‹æ„ä¹‰ã€‚</p><h3 id="Data-Island-Period-ç¼–ç ï¼šTERC4ï¼ˆåé¢ä¿®ï¼‰"><a href="#Data-Island-Period-ç¼–ç ï¼šTERC4ï¼ˆåé¢ä¿®ï¼‰" class="headerlink" title="Data Island Period ç¼–ç ï¼šTERC4ï¼ˆåé¢ä¿®ï¼‰"></a>Data Island Period ç¼–ç ï¼šTERC4ï¼ˆåé¢ä¿®ï¼‰</h3><p>Data Island ä¸­çš„æ‰€æœ‰ 4bit æ•°æ®å¿…é¡»é€šè¿‡ <strong>TERC4 ç¼–ç </strong> è½¬æ¢ä¸º 10bit TMDS å­—ç¬¦ã€‚<br>TERC4 æ˜¯ HDMI å®šä¹‰çš„å›ºå®šç¼–ç è¡¨ï¼Œè¢«ç”¨äº Packet Dataã€Guard Band ç­‰åŒºåŸŸã€‚<br>Data Island Period<br>â”‚<br>â”œâ”€â”€ Guard Band (TERC4)<br>â”œâ”€â”€ Preamble (TERC4)<br>â”‚<br>â””â”€â”€ Packet<br>     â”œâ”€â”€ Header (4bit nibbles â†’ TERC4)<br>     â””â”€â”€ Body   (4bit nibbles â†’ TERC4)</p><p><img src="/img/02_HDMI/13.png" alt="TERC4ç¼–ç ç¤ºæ„"></p><h3 id="Video-Data-Period-1"><a href="#Video-Data-Period-1" class="headerlink" title="Video Data Period"></a>Video Data Period</h3><p>Video Data Period æ˜¯ HDMI ç”¨äºä¼ è¾“å®é™…åƒç´  RGB æ•°æ®çš„åŒºåŸŸã€‚</p><h4 id="1-Video-Data-Period-Signal"><a href="#1-Video-Data-Period-Signal" class="headerlink" title="1. Video Data Period Signal"></a>1. Video Data Period Signal</h4><p>åœ¨ Video Data Period å†…ï¼š</p><ul><li>Video Data çš„ Guard Band ç”¨äºå‘ŠçŸ¥ Sinkï¼šå³å°†è¿›å…¥ Video Data Period</li><li><strong>Guard Bandï¼ˆå‰å¯¼ GBï¼‰</strong>ï¼š3 ä¸ªé€šé“ä¼šå‘é€å›ºå®šçš„ TMDS å­—ç¬¦ï¼Œå›ºå®šå­—ç¬¦å¦‚ä¸‹<br><img src="/img/02_HDMI/14.png" alt="Video Data Period Signal"></li><li><strong>Active Video åŒºåŸŸ</strong>ï¼šä¸‰é€šé“ä¼ è¾“ RGBï¼Œæ¯ä¸ªé€šé“ 8bit</li></ul><h4 id="3-Pixel-Data-åƒç´ æ•°æ®-åé¢ä¿®"><a href="#3-Pixel-Data-åƒç´ æ•°æ®-åé¢ä¿®" class="headerlink" title="3. Pixel Data(åƒç´ æ•°æ®)(åé¢ä¿®)"></a>3. Pixel Data(åƒç´ æ•°æ®)(åé¢ä¿®)</h4><p>Active Video åŒºåŸŸå†…ï¼š</p><ul><li>Channel 0 â†’ Blueï¼ˆ8bitï¼‰</li><li>Channel 1 â†’ Greenï¼ˆ8bitï¼‰</li><li>Channel 2 â†’ Redï¼ˆ8bitï¼‰</li></ul><p>åƒç´ æ•°æ®ç» TMDS ç¼–ç åä»¥ 10bit character è¾“å‡ºã€‚</p><p>ï¼ˆå…·ä½“ Pixel æ ¼å¼ä¸ InfoFrame ä¸­ AVI ä¿¡æ¯ç›¸å…³ï¼Œå°†åœ¨åç»­ç« èŠ‚å±•å¼€ã€‚ï¼‰</p><hr><h3 id="Video-Data-Period-ç¼–ç ï¼šTMDSï¼ˆ8bit-â†’-10bitï¼‰"><a href="#Video-Data-Period-ç¼–ç ï¼šTMDSï¼ˆ8bit-â†’-10bitï¼‰" class="headerlink" title="Video Data Period ç¼–ç ï¼šTMDSï¼ˆ8bit â†’ 10bitï¼‰"></a>Video Data Period ç¼–ç ï¼šTMDSï¼ˆ8bit â†’ 10bitï¼‰</h3><p>TMDS ç¼–ç çš„ç›®æ ‡ï¼š</p><ul><li>å‡å°‘è·³å˜æ¬¡æ•°ï¼ˆå‡å°‘ EM å™ªå£°ï¼‰</li><li>ä¿æŒç›´æµå¹³è¡¡ï¼ˆé•¿æœŸä¼ è¾“ä¸­ 1&#x2F;0 æ•°é‡ä¿æŒå¹³å‡ï¼‰<br>TMDS ç¼–ç åŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼š</li></ul><h4 id="Step-1ï¼š8bit-â†’-9bitï¼ˆæœ€å°åŒ–è·³å˜ï¼‰"><a href="#Step-1ï¼š8bit-â†’-9bitï¼ˆæœ€å°åŒ–è·³å˜ï¼‰" class="headerlink" title="Step 1ï¼š8bit â†’ 9bitï¼ˆæœ€å°åŒ–è·³å˜ï¼‰"></a>Step 1ï¼š8bit â†’ 9bitï¼ˆæœ€å°åŒ–è·³å˜ï¼‰</h4><p>ç¬¬ä¸€æ­¥8-&gt;9bitsçš„ç¼–ç ï¼š9bits codeçš„LSbç­‰äºè¾“å…¥çš„8bitsçš„LSBï¼Œéšåçš„7bitï¼Œæ¯ä¸€bitçš„è®¡ç®—éƒ½åŸºäºå¦‚ä¸‹å…¬å¼: output[n] &#x3D; input[n] OR output[n-1]ï¼Œæˆ–output[n] &#x3D; input[n] NOR output[n-1]ã€‚å…·ä½“è®¡ç®—é€‰æ‹©XORï¼ˆå¼‚æˆ–ï¼‰è¿˜æ˜¯XNORï¼ˆåŒæˆ–ï¼‰ï¼Œå–å†³äºå“ªç§æ¨¡å¼ç¼–ç å¾—åˆ°çš„9bits codeä¸­çš„è·³å˜æ›´å°‘ï¼ˆç®—æ³•ä½¿ç”¨çš„åˆ¤æ–­æ¡ä»¶å¦‚ä¸‹æµç¨‹å›¾æ‰€ç¤ºï¼‰ã€‚9bits codeçš„MSbç”¨äºæŒ‡ç¤ºå½“å‰ç¼–ç ä½¿ç”¨çš„æ˜¯ORè¿˜æ˜¯NORã€‚</p><h5 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h5><p>åœ¨ HDMI çš„ TMDSï¼ˆTransition Minimized Differential Signalingï¼‰ç¼–ç ä¸­ï¼Œä¸ºäº†å‡å°‘ä¿¡å·è·³å˜ã€é™ä½ç”µç£å¹²æ‰°ï¼ˆEMIï¼‰ï¼Œå¯¹åŸå§‹ 8bit æ•°æ®è¿›è¡Œç¼–ç æ—¶ä¼šå°è¯•ä¸¤ç§æ–¹å¼ï¼š<strong>XOR</strong> å’Œ <strong>XNOR</strong>ï¼Œå¹¶é€‰æ‹©å…¶ä¸­<strong>è·³å˜æ¬¡æ•°æ›´å°‘</strong>çš„ä¸€ç§ã€‚æœ€ç»ˆè¾“å‡ºä¸º 9bit ç¼–ç ç»“æœï¼Œå…¶ä¸­æœ€é«˜ä½ï¼ˆMSBï¼‰ç”¨äºæŒ‡ç¤ºæ‰€é€‰çš„ç¼–ç æ–¹å¼ã€‚</p><p>å‡è®¾è¾“å…¥ 8bit æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">input</span> = <span class="number">1100_1010</span></span><br><span class="line">         â†‘    â†‘</span><br><span class="line">       MSB    LSB</span><br><span class="line">ç¬¬ <span class="number">1</span> æ­¥ï¼šç”Ÿæˆ 9bit çš„è¾“å‡ºï¼ˆå…ˆè¯• XORï¼‰</span><br><span class="line">â‘  output[<span class="number">0</span>] = <span class="built_in">input</span>[<span class="number">0</span>]ï¼ˆLSB å¯¹é½ï¼‰</span><br><span class="line">å‡è®¾æœ€å³è¾¹æ˜¯ bit0ï¼š</span><br><span class="line"><span class="built_in">input</span>:   i7 i6 i5 i4 i3 i2 i1 i0</span><br><span class="line">                         â†‘</span><br><span class="line">output0 = i0</span><br><span class="line">ä¾‹å¦‚ï¼š</span><br><span class="line">output[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">â‘¡ ä» output[<span class="number">1</span>] å¼€å§‹ä¾æ¬¡è®¡ç®—ï¼š</span><br><span class="line">output[n] = <span class="built_in">input</span>[n] XOR output[n-<span class="number">1</span>]</span><br><span class="line">ä¸¾ä¾‹ï¼š</span><br><span class="line">output[<span class="number">1</span>] = <span class="built_in">input</span>[<span class="number">1</span>] XOR output[<span class="number">0</span>]</span><br><span class="line">output[<span class="number">2</span>] = <span class="built_in">input</span>[<span class="number">2</span>] XOR output[<span class="number">1</span>]</span><br><span class="line">output[<span class="number">3</span>] = <span class="built_in">input</span>[<span class="number">3</span>] XOR output[<span class="number">2</span>]</span><br><span class="line">...</span><br><span class="line">ä¸€ç›´åˆ° output[<span class="number">7</span>]</span><br><span class="line">è¿™æ ·å°±å¾—åˆ° ä¸€ä¸ª 8bit åºåˆ—ï¼ˆé€’æ¨ç”Ÿæˆï¼‰</span><br><span class="line">â‘¢ ç¬¬ 9bitï¼ˆMSBï¼‰æ ‡è®°ï¼š</span><br><span class="line">MSB = <span class="number">0</span>  (ä»£è¡¨ä½¿ç”¨ XOR)</span><br><span class="line">ç¬¬ <span class="number">2</span> æ­¥ï¼šå†è¯•ä¸€æ¬¡ XNOR</span><br><span class="line">åŒæ ·æ­¥éª¤ï¼š</span><br><span class="line">output[n] = <span class="built_in">input</span>[n] XNOR output[n-<span class="number">1</span>]</span><br><span class="line">è¿™æ ·å¾—åˆ°å¦ä¸€å¥— 9bit åºåˆ—ã€‚</span><br><span class="line">ç¬¬ <span class="number">3</span> æ­¥ï¼šæ¯”è¾ƒä¸¤å¥— 9bit çš„è·³å˜æ¬¡æ•°</span><br><span class="line">ä¾‹å¦‚ä½ ç®—å‡ºæ¥ï¼š</span><br><span class="line">XOR æ–¹å¼ï¼šå‡ºç° <span class="number">5</span> æ¬¡è·³å˜</span><br><span class="line">XNOR æ–¹å¼ï¼šå‡ºç° <span class="number">2</span> æ¬¡è·³å˜</span><br><span class="line">ğŸ‘‰ é€‰æ‹©è·³å˜å°‘çš„ XNOR</span><br><span class="line">å¹¶æŠŠ 9bit çš„ MSB è®¾ç½®ä¸ºï¼š</span><br><span class="line">MSB = <span class="number">1</span>   ï¼ˆä»£è¡¨é€‰æ‹©äº† XNORï¼‰</span><br></pre></td></tr></table></figure><h4 id="Step-2ï¼š9bit-â†’-10bitï¼ˆä¿æŒç›´æµå¹³è¡¡ï¼‰"><a href="#Step-2ï¼š9bit-â†’-10bitï¼ˆä¿æŒç›´æµå¹³è¡¡ï¼‰" class="headerlink" title="Step 2ï¼š9bit â†’ 10bitï¼ˆä¿æŒç›´æµå¹³è¡¡ï¼‰"></a>Step 2ï¼š9bit â†’ 10bitï¼ˆä¿æŒç›´æµå¹³è¡¡ï¼‰</h4><ul><li>ç¬¬äºŒæ­¥9-&gt;10bitsçš„ç¼–ç ï¼šå®ç°æ•°æ®æµçš„ç›´æµå¹³è¡¡ã€‚æ·»åŠ ä¸€ä¸ªç¬¬10bitçš„æœ€é«˜ä½ï¼Œä»¥æŒ‡ç¤ºæ˜¯å¦å¯¹æ•°æ®è¿›è¡ŒæŒ‰ä½å–åã€‚ç¼–ç å™¨åŸºäºç›®å‰å·²ä¼ è¾“çš„æ•°æ®æµä¸­0å’Œ1çš„æ•°é‡å·®å¼‚ï¼Œä»¥åŠå½“å‰characterå·²ç¼–ç çš„ä½8bitsçš„0å’Œ1çš„æ•°é‡å·®å¼‚ï¼Œå†³å®šæ˜¯å¦è¿›è¡Œå–åã€‚</li><li>è¿™é‡Œçš„å–åæ˜¯æ ¹æ®å‰é¢å‘äº†å¾ˆä¹…çš„æ•°æ®ï¼Œè®¡ç®—å‡ºæ¥ç°åœ¨æ˜¯0å¤šè¿˜æ˜¯1å¤šï¼Œç„¶åå†³å®šæ˜¯å¦å–åè¿™æ ·</li><li>æ‰€æœ‰çš„ç¼–ç æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ•´ä¸ªç¼–ç ä¼šäº§ç”Ÿ460ç§ä¸åŒçš„10 bits charactersã€‚åœ¨ç¼–ç å™¨æ­£ç¡®å·¥ä½œçš„æƒ…å†µä¸‹ï¼Œä¸åº”åœ¨Video Data Periodäº§ç”Ÿå…¶ä»–çš„charactersã€‚<br><img src="/img/02_HDMI/15.png" alt="TMDSç¼–ç æµç¨‹1"><br><img src="/img/02_HDMI/16.png" alt="TMDSç¼–ç æµç¨‹2"></li></ul><h4 id="TMDS-å­—ç¬¦é›†"><a href="#TMDS-å­—ç¬¦é›†" class="headerlink" title="TMDS å­—ç¬¦é›†"></a>TMDS å­—ç¬¦é›†</h4><p>TMDS ç¼–ç å…±ç”Ÿæˆçº¦ <strong>460 ç§æœ‰æ•ˆçš„ 10bit å­—ç¬¦</strong>ã€‚<br>Video Data Period å†…ä¸åº”å‡ºç°é TMDS ç¼–ç å­—ç¬¦ï¼›<br>Guard Bandã€Control Periodã€Data Island ä½¿ç”¨ä¸åŒå­—ç¬¦é›†ï¼ŒSink å¯æ ¹æ®å­—ç¬¦ç±»å‹è¯†åˆ«å½“å‰ Periodã€‚</p>]]></content>
    
    
    <summary type="html">HDMI1.4åè®®é˜…è¯»ç¬”è®°</summary>
    
    
    
    <category term="æ¥å£åè®®" scheme="https://djdgctw.github.io/categories/%E6%8E%A5%E5%8F%A3%E5%8D%8F%E8%AE%AE/"/>
    
    
    <category term="HDMI" scheme="https://djdgctw.github.io/tags/HDMI/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäº Python çš„ Cocotb ä»¿çœŸç¯å¢ƒé…ç½®ï¼šVerilator Â· Cocotb Â· GTKWave</title>
    <link href="https://djdgctw.github.io/2025/11/23/%E5%9F%BA%E4%BA%8Epython%E7%9A%84cocotb%E5%BA%93%E5%AF%B9verilog%E8%BF%9B%E8%A1%8C%E4%BB%BF%E7%9C%9F%E6%95%99%E7%A8%8B-%E5%89%8D%E4%BC%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%8F%8A%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"/>
    <id>https://djdgctw.github.io/2025/11/23/%E5%9F%BA%E4%BA%8Epython%E7%9A%84cocotb%E5%BA%93%E5%AF%B9verilog%E8%BF%9B%E8%A1%8C%E4%BB%BF%E7%9C%9F%E6%95%99%E7%A8%8B-%E5%89%8D%E4%BC%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%8F%8A%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/</id>
    <published>2025-11-23T06:30:00.000Z</published>
    <updated>2025-11-23T06:31:28.059Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>â€œè·‘é€š demo ä¹‹å‰ï¼Œå…ˆæŠŠç¯å¢ƒé…ç¨³å®šã€‚â€ â€”â€” æŠŠæ¯ä¸€æ­¥éƒ½å†™æ¸…æ¥šï¼Œåç»­å®éªŒå°±èƒ½å¿«é€Ÿå¤ç°ã€‚</p></blockquote><h2 id="1-Python-Cocotb-å®‰è£…"><a href="#1-Python-Cocotb-å®‰è£…" class="headerlink" title="1. Python &amp; Cocotb å®‰è£…"></a>1. Python &amp; Cocotb å®‰è£…</h2><h3 id="1-1-Python-ç¯å¢ƒ"><a href="#1-1-Python-ç¯å¢ƒ" class="headerlink" title="1.1 Python ç¯å¢ƒ"></a>1.1 Python ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¨è Python 3.10+ï¼Œconda / pyenv å‡å¯</span></span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install python3 python3-pip python3-venv -y</span><br><span class="line"></span><br><span class="line">python3 -m venv ~/.venvs/cocotb</span><br><span class="line"><span class="built_in">source</span> ~/.venvs/cocotb/bin/activate</span><br></pre></td></tr></table></figure><h3 id="1-2-å®‰è£…-Cocotb-åŠå¸¸ç”¨ä¾èµ–"><a href="#1-2-å®‰è£…-Cocotb-åŠå¸¸ç”¨ä¾èµ–" class="headerlink" title="1.2 å®‰è£… Cocotb åŠå¸¸ç”¨ä¾èµ–"></a>1.2 å®‰è£… Cocotb åŠå¸¸ç”¨ä¾èµ–</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install --upgrade pip wheel</span><br><span class="line">pip install cocotb cocotb-bus pytest</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœä½¿ç”¨ VS Codeï¼Œè®°å¾—æŠŠè™šæ‹Ÿç¯å¢ƒæŒ‡å‘ <code>~/.venvs/cocotb</code>.</p></blockquote><h2 id="2-Verilator-å®‰è£…"><a href="#2-Verilator-å®‰è£…" class="headerlink" title="2. Verilator å®‰è£…"></a>2. Verilator å®‰è£…</h2><h3 id="2-1-apt-å®‰è£…ï¼ˆç®€å•ï¼‰"><a href="#2-1-apt-å®‰è£…ï¼ˆç®€å•ï¼‰" class="headerlink" title="2.1 apt å®‰è£…ï¼ˆç®€å•ï¼‰"></a>2.1 apt å®‰è£…ï¼ˆç®€å•ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install verilator -y</span><br><span class="line">verilator --version</span><br></pre></td></tr></table></figure><h3 id="2-2-æºç å®‰è£…ï¼ˆéœ€è¦æœ€æ–°ç‰ˆæœ¬æ—¶ï¼‰"><a href="#2-2-æºç å®‰è£…ï¼ˆéœ€è¦æœ€æ–°ç‰ˆæœ¬æ—¶ï¼‰" class="headerlink" title="2.2 æºç å®‰è£…ï¼ˆéœ€è¦æœ€æ–°ç‰ˆæœ¬æ—¶ï¼‰"></a>2.2 æºç å®‰è£…ï¼ˆéœ€è¦æœ€æ–°ç‰ˆæœ¬æ—¶ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install git perl python3 make autoconf g++ flex bison libfl2 libfl-dev \</span><br><span class="line">  zlibc zlib1g zlib1g-dev -y</span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/verilator/verilator.git</span><br><span class="line"><span class="built_in">cd</span> verilator</span><br><span class="line">git checkout v5.026   <span class="comment"># æ ¹æ®éœ€è¦é€‰æ‹©ç‰ˆæœ¬</span></span><br><span class="line">autoconf</span><br><span class="line">./configure</span><br><span class="line">make -j$(<span class="built_in">nproc</span>)</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœç³»ç»Ÿå·²æœ‰æ—§ç‰ˆæœ¬ï¼Œå¯åœ¨ <code>~/.bashrc</code> ä¸­å°† <code>/usr/local/bin</code> æåˆ° <code>PATH</code> å‰é¢ï¼Œè®©æ–°ç‰ˆæœ¬ä¼˜å…ˆã€‚</p></blockquote><h2 id="3-GTKWave-å®‰è£…ï¼ˆæ³¢å½¢æŸ¥çœ‹ï¼‰"><a href="#3-GTKWave-å®‰è£…ï¼ˆæ³¢å½¢æŸ¥çœ‹ï¼‰" class="headerlink" title="3. GTKWave å®‰è£…ï¼ˆæ³¢å½¢æŸ¥çœ‹ï¼‰"></a>3. GTKWave å®‰è£…ï¼ˆæ³¢å½¢æŸ¥çœ‹ï¼‰</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install gtkwave -y</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨å¯åŠ¨æ–¹å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gtkwave logs/dump.vcd &amp;</span><br></pre></td></tr></table></figure><p>é…åˆ Verilator&#x2F;Cocotb ç”Ÿæˆçš„ <code>.vcd</code> æˆ– <code>.fst</code> æ–‡ä»¶å³å¯ã€‚</p><h2 id="4-ä»¿çœŸå·¥ç¨‹æ¨¡æ¿åˆå§‹åŒ–"><a href="#4-ä»¿çœŸå·¥ç¨‹æ¨¡æ¿åˆå§‹åŒ–" class="headerlink" title="4. ä»¿çœŸå·¥ç¨‹æ¨¡æ¿åˆå§‹åŒ–"></a>4. ä»¿çœŸå·¥ç¨‹æ¨¡æ¿åˆå§‹åŒ–</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ~/workspace/cocotb-demo &amp;&amp; <span class="built_in">cd</span> <span class="variable">$_</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/djdgctw/first_cocotb_testbench.git</span><br><span class="line"><span class="built_in">cd</span> first_cocotb_testbench/01_base</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">which</span> verilator</span><br><span class="line">python -c <span class="string">&quot;import cocotb; print(cocotb.__version__)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œä¸€æ¬¡ demo</span></span><br><span class="line">make run-logged SIM=verilator</span><br></pre></td></tr></table></figure><p>è‹¥è¾“å‡º <code>INFO: Running on Verilator ...</code> å¹¶ç”Ÿæˆ <code>logs/report.log</code>ï¼Œè¯´æ˜ç¯å¢ƒ OKã€‚</p><h2 id="5-å¸¸è§é—®é¢˜"><a href="#5-å¸¸è§é—®é¢˜" class="headerlink" title="5. å¸¸è§é—®é¢˜"></a>5. å¸¸è§é—®é¢˜</h2><table><thead><tr><th>ç°è±¡</th><th>å¤„ç†</th></tr></thead><tbody><tr><td><code>verilator: command not found</code></td><td>æ£€æŸ¥ <code>PATH</code>ï¼Œç¡®è®¤ <code>/usr/bin</code> æˆ– <code>/usr/local/bin</code> è¢«åŒ…å«ã€‚</td></tr><tr><td><code>ImportError: No module named &#39;cocotb&#39;</code></td><td>è™šæ‹Ÿç¯å¢ƒæœªæ¿€æ´»æˆ– pip å®‰è£…åœ¨ç³»ç»Ÿ Pythonï¼Œé‡æ–° <code>source ~/.venvs/cocotb/bin/activate</code>ã€‚</td></tr><tr><td>GTKWave æ‰“ä¸å¼€ä¸­æ–‡è·¯å¾„</td><td>é¿å…æŠŠæ³¢å½¢æ–‡ä»¶æ”¾åœ¨å«ä¸­æ–‡ç©ºæ ¼çš„è·¯å¾„ï¼Œæˆ–ä½¿ç”¨ <code>LANG=en_US.UTF-8 gtkwave ...</code>ã€‚</td></tr></tbody></table><h2 id="6-åç»­æ–‡ç« "><a href="#6-åç»­æ–‡ç« " class="headerlink" title="6. åç»­æ–‡ç« "></a>6. åç»­æ–‡ç« </h2><ul><li><a href="../%E5%9F%BA%E4%BA%8Epython%E7%9A%84cocotb%E5%BA%93%E5%AF%B9verilog%E8%BF%9B%E8%A1%8C%E4%BB%BF%E7%9C%9F%E6%95%99%E7%A8%8B-%E4%B8%80">åŸºäº Python çš„ Cocotb åº“å¯¹ Verilog è¿›è¡Œä»¿çœŸæ•™ç¨‹ï¼ˆä¸€ï¼‰</a></li><li>å³å°†æ›´æ–°ï¼šæ³¢å½¢å¯è§†åŒ–ã€ä¸ ModelSim&#x2F;Vivado IP ååŒçš„å®è·µ</li></ul><p>åšå¥½ç¯å¢ƒä¹‹åï¼Œåç»­çš„ Cocotb å®éªŒå°±åªå‰©â€œå†™ testbench + make runâ€è¿™ä¸¤ä¸ªåŠ¨ä½œï¼Œç¥ç©å¾—å¼€å¿ƒã€‚</p>]]></content>
    
    
    <summary type="html">è®°å½•åœ¨ Ubuntu/WSL ä¸Šæ­å»º Cocotb + Verilator + GTKWave ä»¿çœŸç¯å¢ƒçš„å…¨è¿‡ç¨‹ï¼Œæ–¹ä¾¿å¿«é€Ÿå¤åˆ»ã€‚</summary>
    
    
    
    <category term="å·¥å…·é“¾" scheme="https://djdgctw.github.io/categories/%E5%B7%A5%E5%85%B7%E9%93%BE/"/>
    
    
    <category term="cocotb" scheme="https://djdgctw.github.io/tags/cocotb/"/>
    
    <category term="verilator" scheme="https://djdgctw.github.io/tags/verilator/"/>
    
    <category term="gtkwave" scheme="https://djdgctw.github.io/tags/gtkwave/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäº Python çš„ Cocotb åº“å¯¹ Verilog è¿›è¡Œä»¿çœŸæ•™ç¨‹ï¼ˆä¸€ï¼‰</title>
    <link href="https://djdgctw.github.io/2025/11/23/%E5%9F%BA%E4%BA%8Epython%E7%9A%84cocotb%E5%BA%93%E5%AF%B9verilog%E8%BF%9B%E8%A1%8C%E4%BB%BF%E7%9C%9F%E6%95%99%E7%A8%8B-%E4%B8%80/"/>
    <id>https://djdgctw.github.io/2025/11/23/%E5%9F%BA%E4%BA%8Epython%E7%9A%84cocotb%E5%BA%93%E5%AF%B9verilog%E8%BF%9B%E8%A1%8C%E4%BB%BF%E7%9C%9F%E6%95%99%E7%A8%8B-%E4%B8%80/</id>
    <published>2025-11-23T05:24:27.000Z</published>
    <updated>2025-11-23T06:28:38.974Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¡¹ç›®åœ°å€"><a href="#é¡¹ç›®åœ°å€" class="headerlink" title="é¡¹ç›®åœ°å€"></a>é¡¹ç›®åœ°å€</h2><p>ğŸ‘‰ <a href="https://github.com/djdgctw/first_cocotb_testbench">https://github.com/djdgctw/first_cocotb_testbench</a></p><p>æœ¬æ•™ç¨‹å¯¹åº”ä»“åº“çš„ <code>01_base</code> ç¤ºä¾‹ï¼Œæ˜¯ Verilator Ã— Cocotb å…¥é—¨çš„æœ€å°å¯è¿è¡Œå·¥ç¨‹ã€‚</p><h2 id="1-è·‘é€š-01-base-åŸºç¡€æµç¨‹"><a href="#1-è·‘é€š-01-base-åŸºç¡€æµç¨‹" class="headerlink" title="1. è·‘é€š 01_base åŸºç¡€æµç¨‹"></a>1. è·‘é€š 01_base åŸºç¡€æµç¨‹</h2><p>ç¯å¢ƒè¦æ±‚ï¼š</p><ol><li>Ubuntuï¼ˆæˆ– WSL2ï¼‰</li><li>Verilatorï¼ˆapt æˆ–æºç ç¼–è¯‘å‡å¯ï¼‰</li><li>Pythonï¼ˆconda &#x2F; ç³»ç»Ÿ Python å‡å¯ï¼‰</li><li><code>pip install cocotb</code></li></ol><p>å…‹éš†ä»“åº“åè¿›å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> first_cocotb_testbench/01_base</span><br></pre></td></tr></table></figure><p>é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š<br><img src="/img/01_cocotb/01.png" alt="01_baseé¡¹ç›®ç»“æ„ç¤ºæ„å›¾"></p><h2 id="2-ç¤ºä¾‹æµç¨‹è®²è§£"><a href="#2-ç¤ºä¾‹æµç¨‹è®²è§£" class="headerlink" title="2. ç¤ºä¾‹æµç¨‹è®²è§£"></a>2. ç¤ºä¾‹æµç¨‹è®²è§£</h2><p>åœ¨ <code>01_base</code> ç›®å½•ä¸‹æ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make run-logged SIM=verilator</span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤ä¼šï¼š</p><ul><li>è°ƒç”¨ cocotb çš„ Makefile ä½“ç³»</li><li>ä½¿ç”¨ Verilator å¯¹ <code>src/dff.sv</code> è¿›è¡Œç¼–è¯‘</li><li>è¿è¡Œ Python ä¾§çš„ testbench</li><li>å°†è¿è¡Œæ—¥å¿—ä¸æ³¢å½¢å­˜å…¥ <code>logs/</code> ç›®å½•ï¼ˆå« <code>report.log</code> ä¸æ³¢å½¢æ–‡ä»¶ï¼‰</li></ul><p>Makefile å…³é”®é€»è¾‘å¦‚ä¸‹ï¼š<br><img src="/img/01_cocotb/02.png" alt="makefileéƒ¨åˆ†ä»£ç "></p><h2 id="3-åŸç†è®²è§£"><a href="#3-åŸç†è®²è§£" class="headerlink" title="3. åŸç†è®²è§£"></a>3. åŸç†è®²è§£</h2><p>æœ¬ç¤ºä¾‹ç”± Verilog è®¾è®¡æ–‡ä»¶ <code>dff.sv</code> å’Œ Python Cocotb æµ‹è¯•æ–‡ä»¶ <code>test_dff.py</code> ç»„æˆï¼ŒäºŒè€…é€šè¿‡ cocotb çš„ VPI&#x2F;PLI æ¥å£å»ºç«‹äº¤äº’ã€‚</p><h3 id="3-1-Verilog-ä»£ç è®²è§£ï¼ˆè¢«æµ‹æ¨¡å—-DUTï¼‰"><a href="#3-1-Verilog-ä»£ç è®²è§£ï¼ˆè¢«æµ‹æ¨¡å—-DUTï¼‰" class="headerlink" title="3.1 Verilog ä»£ç è®²è§£ï¼ˆè¢«æµ‹æ¨¡å— DUTï¼‰"></a>3.1 Verilog ä»£ç è®²è§£ï¼ˆè¢«æµ‹æ¨¡å— DUTï¼‰</h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1us/1ns</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> dff (</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>] q,</span><br><span class="line">    <span class="keyword">input</span>  <span class="keyword">logic</span>       clk,</span><br><span class="line">    <span class="keyword">input</span>  <span class="keyword">logic</span> [<span class="number">3</span>:<span class="number">0</span>] d</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    q &lt;= d;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><p>è§£é‡Šï¼š</p><ul><li>ä¸Šå‡æ²¿é‡‡æ ·ï¼šæ¯ä¸ª <code>posedge clk</code>ï¼Œ<code>q</code> éƒ½ä¼šæ›´æ–°ä¸º <code>d</code></li><li>å»¶è¿Ÿè¯­ä¹‰ï¼šè¡Œä¸ºç­‰ä»·äº â€œq &#x3D; d ä¸Šä¸€æ‹çš„å€¼â€</li></ul><h3 id="3-2-Cocotb-Python-æµ‹è¯•ä»£ç è®²è§£"><a href="#3-2-Cocotb-Python-æµ‹è¯•ä»£ç è®²è§£" class="headerlink" title="3.2 Cocotb Python æµ‹è¯•ä»£ç è®²è§£"></a>3.2 Cocotb Python æµ‹è¯•ä»£ç è®²è§£</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> cocotb</span><br><span class="line"><span class="keyword">from</span> cocotb.clock <span class="keyword">import</span> Clock</span><br><span class="line"><span class="keyword">from</span> cocotb.triggers <span class="keyword">import</span> FallingEdge</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="meta">@cocotb.test()</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">test_dff_simple</span>(<span class="params">dut</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;éªŒè¯ d èƒ½æ­£ç¡®ä¼ é€’åˆ° q&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    logger = logging.getLogger(<span class="string">&quot;my_testbench&quot;</span>)</span><br><span class="line">    logger.setLevel(logging.DEBUG)</span><br><span class="line"></span><br><span class="line">    clock = Clock(dut.clk, <span class="number">10</span>, unit=<span class="string">&quot;us&quot;</span>)</span><br><span class="line">    cocotb.start_soon(clock.start())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        val = random.randint(<span class="number">0</span>, <span class="number">7</span>)</span><br><span class="line">        dut.d.value = val</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> FallingEdge(dut.clk)</span><br><span class="line"></span><br><span class="line">        logger.info(<span class="string">f&quot;å‘¨æœŸ <span class="subst">&#123;i&#125;</span>: d=<span class="subst">&#123;dut.d.value&#125;</span>, q=<span class="subst">&#123;dut.q.value&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> dut.q.value == val, <span class="string">f&quot;ç¬¬ <span class="subst">&#123;i&#125;</span> æ¬¡æ£€æŸ¥å¤±è´¥ï¼šæœŸæœ› <span class="subst">&#123;val&#125;</span>ï¼Œå®é™… <span class="subst">&#123;dut.q.value&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure><p>é‡ç‚¹ï¼š</p><ul><li><code>@cocotb.test()</code>ï¼šå£°æ˜ Python æµ‹è¯•ç”¨ä¾‹</li><li><code>Clock(...)</code>ï¼šåœ¨ Python ä¾§åˆ›å»ºæ—¶é’Ÿå¹¶é©±åŠ¨ DUT</li><li><code>await FallingEdge(...)</code>ï¼šäº‹ä»¶é©±åŠ¨å¼ä»¿çœŸ</li><li><code>.value</code> æ˜¯ cocotb å†™å…¥å’Œè¯»å–ä¿¡å·çš„æ ‡å‡†æ–¹å¼</li><li>æ–­è¨€é”™è¯¯ä¼šè‡ªåŠ¨æ ‡çº¢ä¸­æ­¢</li></ul><h3 id="3-3-Makefile-æ ¸å¿ƒéƒ¨åˆ†è§£é‡Š"><a href="#3-3-Makefile-æ ¸å¿ƒéƒ¨åˆ†è§£é‡Š" class="headerlink" title="3.3 Makefile æ ¸å¿ƒéƒ¨åˆ†è§£é‡Š"></a>3.3 Makefile æ ¸å¿ƒéƒ¨åˆ†è§£é‡Š</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> PYTHONPATH := <span class="variable">$(PWD)</span>/testbench:<span class="variable">$(PYTHONPATH)</span></span><br><span class="line">TOPLEVEL_LANG = verilog</span><br><span class="line">VERILOG_SOURCES = <span class="variable">$(PWD)</span>/src/dff.sv</span><br><span class="line">TOPLEVEL = dff</span><br><span class="line">MODULE = test_dff</span><br><span class="line">SIM ?= verilator</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$(<span class="built_in">shell</span> cocotb-config --makefiles)</span>/Makefile.sim</span><br></pre></td></tr></table></figure><p>ç®€è¦è¯´æ˜ï¼š</p><ul><li><code>TOPLEVEL</code> å¿…é¡»ä¸ Verilog ä¸­çš„æ¨¡å—åä¸€è‡´</li><li><code>MODULE=test_dff</code> æŒ‡å®š Python æµ‹è¯•å…¥å£</li><li><code>VERILOG_SOURCES</code> å†³å®šå‚ä¸ä»¿çœŸçš„ RTL æ–‡ä»¶</li><li><code>cocotb-config</code> è‡ªåŠ¨é€‰æ‹©æ­£ç¡®çš„ä»¿çœŸå™¨åç«¯</li></ul><blockquote><p><strong>æ¢æ¨¡å—æ—¶ï¼Œåªéœ€æ”¹ï¼š</strong><br><code>src/*.sv</code>ã€<code>TOPLEVEL</code>ã€<code>MODULE</code>ï¼Œå…¶ä½™é€»è¾‘æ— éœ€ä¿®æ”¹ã€‚</p></blockquote><h2 id="4-å°ç»“"><a href="#4-å°ç»“" class="headerlink" title="4. å°ç»“"></a>4. å°ç»“</h2><p>æœ¬ç¯‡ç¤ºä¾‹å±•ç¤ºäº† Cocotb æœ€å°å¯è¿è¡Œå·¥ç¨‹çš„ç»“æ„å’ŒåŸç†ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>Verilator + Cocotb çš„ååŒä»¿çœŸæµç¨‹</li><li>Verilog DUT çš„æ„æˆ</li><li>Python å¼‚æ­¥ testbench çš„å†™æ³•</li><li>Makefile å¦‚ä½•å°†ä¸¤è€…ä¸²è”</li></ul><p>åç»­ç¯‡ç« å°†ç»§ç»­æ›´æ–°ï¼š</p><ul><li>å¦‚ä½•åˆ©ç”¨ Python æŠŠä»¿çœŸç»“æœè½¬æ¢ä¸ºå¯è§†åŒ–å›¾è¡¨</li><li>å¦‚ä½•è®© Cocotb é€šè¿‡ ModelSim æ”¯æŒå¸¦ Vivado IP çš„ä»¿çœŸ</li></ul>]]></content>
    
    
    <summary type="html">åŸºäº Verilator ä¸ Cocotb å¯¹ Verilog æ¨¡å—è¿›è¡ŒååŒä»¿çœŸçš„åŸºç¡€æµç¨‹ä¸åŸç†è®²è§£</summary>
    
    
    
    
    <category term="cocotb" scheme="https://djdgctw.github.io/tags/cocotb/"/>
    
    <category term="verilog" scheme="https://djdgctw.github.io/tags/verilog/"/>
    
  </entry>
  
</feed>
